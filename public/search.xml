<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>Hexo搭建个人博客：yilia主题配置(五) - 其他配置</title>
    <url>/blog/archives/915cb590.html</url>
    <content><![CDATA[<p>本文主要讲述 <code>Hexo-yilia</code> 主题对于文章持久化及天气等插件的配置。</p>
<a id="more"></a>

<h2 id="1-持久化URL"><a href="#1-持久化URL" class="headerlink" title="1.持久化URL"></a>1.持久化URL</h2><ul>
<li>首先，安装插件：</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm install hexo-abbrlink --save</span><br></pre></td></tr></table></figure>

<ul>
<li>在根目录中打开 <code>_config.yml</code> 文件，找到 <code>permalink</code> 项，修改：</li>
</ul>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># permalink: :year/:month/:day/:title/  # 原代码, 分层较深</span></span><br><span class="line"><span class="attr">permalink:</span> <span class="string">archives/:abbrlink.html</span></span><br><span class="line"><span class="attr">permalink_defaults:</span></span><br><span class="line"><span class="attr">abbrlink:</span></span><br><span class="line">  <span class="attr">alg:</span> <span class="string">crc32</span>  <span class="comment"># 算法：crc16(default) and crc32</span></span><br><span class="line">  <span class="attr">rep:</span> <span class="string">hex</span>    <span class="comment"># 进制：dec(default) and hex</span></span><br></pre></td></tr></table></figure>

<ul>
<li>分类和标签预设</li>
</ul>
<p>中英文映射：</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># e.g.</span></span><br><span class="line"><span class="attr">category_map:</span></span><br><span class="line">  <span class="string">网站:</span> <span class="string">site</span></span><br><span class="line">  <span class="string">小程序:</span> <span class="string">miniprogram</span></span><br><span class="line">  <span class="string">开发工具:</span> <span class="string">tools</span></span><br><span class="line"><span class="attr">tag_map:</span></span><br><span class="line">  <span class="string">标签分类:</span> <span class="string">kinds</span></span><br><span class="line">  <span class="string">基础:</span> <span class="string">basic</span></span><br><span class="line">  <span class="string">Web框架:</span> <span class="string">web_frame</span></span><br><span class="line">  <span class="string">数据库操作:</span> <span class="string">sql_action</span></span><br><span class="line">  <span class="string">数据分析:</span> <span class="string">data_analysis</span></span><br><span class="line">  <span class="string">爬虫:</span> <span class="string">spider</span></span><br><span class="line">  <span class="string">自动化测试:</span> <span class="string">auto_test</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>参考：<a href="https://blog.csdn.net/weixin_41287260/article/details/103049779" target="_blank" rel="noopener">hexo持久化配置</a></p>
</blockquote>
<h2 id="2-文章图片的导入"><a href="#2-文章图片的导入" class="headerlink" title="2.文章图片的导入"></a>2.文章图片的导入</h2><blockquote>
<p>在hexo主题中，直接用markdown的语法：如 <img src="/blog/archives/%E5%9B%BE%E7%89%87%E5%9C%B0%E5%9D%80" alt>，是不生效的</p>
</blockquote>
<h3 id="方式一：上传七牛云-入门详情"><a href="#方式一：上传七牛云-入门详情" class="headerlink" title="方式一：上传七牛云 入门详情"></a>方式一：上传七牛云 <a href="https://support.qiniu.com/tickets/new/" target="_blank" rel="noopener">入门详情</a></h3><p>使用： 获取七牛云图片链接</p>
<h3 id="方式二：使用插件："><a href="#方式二：使用插件：" class="headerlink" title="方式二：使用插件："></a>方式二：使用插件：</h3><ul>
<li>安装插件</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm install hexo-asset-image --save</span><br></pre></td></tr></table></figure>
<ul>
<li>打开文件 <code>node_modules/hexo-asset-image/index.js</code> ，替换内容为下面的代码：</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="meta">'use strict'</span>;</span><br><span class="line"><span class="keyword">var</span> cheerio = <span class="built_in">require</span>(<span class="string">'cheerio'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// http://stackoverflow.com/questions/14480345/how-to-get-the-nth-occurrence-in-a-string</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getPosition</span>(<span class="params">str, m, i</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> str.split(m, i).join(m).length;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> version = <span class="built_in">String</span>(hexo.version).split(<span class="string">'.'</span>);</span><br><span class="line">hexo.extend.filter.register(<span class="string">'after_post_render'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">data</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">var</span> config = hexo.config;</span><br><span class="line">  <span class="keyword">if</span>(config.post_asset_folder)&#123;</span><br><span class="line">        <span class="keyword">var</span> link = data.permalink;</span><br><span class="line">    <span class="keyword">if</span>(version.length &gt; <span class="number">0</span> &amp;&amp; <span class="built_in">Number</span>(version[<span class="number">0</span>]) == <span class="number">3</span>)</span><br><span class="line">       <span class="keyword">var</span> beginPos = getPosition(link, <span class="string">'/'</span>, <span class="number">1</span>) + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">       <span class="keyword">var</span> beginPos = getPosition(link, <span class="string">'/'</span>, <span class="number">3</span>) + <span class="number">1</span>;</span><br><span class="line">    <span class="comment">// In hexo 3.1.1, the permalink of "about" page is like ".../about/index.html".</span></span><br><span class="line">    <span class="keyword">var</span> endPos = link.lastIndexOf(<span class="string">'/'</span>) + <span class="number">1</span>;</span><br><span class="line">    link = link.substring(beginPos, endPos);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> toprocess = [<span class="string">'excerpt'</span>, <span class="string">'more'</span>, <span class="string">'content'</span>];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; toprocess.length; i++)&#123;</span><br><span class="line">      <span class="keyword">var</span> key = toprocess[i];</span><br><span class="line"> </span><br><span class="line">      <span class="keyword">var</span> $ = cheerio.load(data[key], &#123;</span><br><span class="line">        ignoreWhitespace: <span class="literal">false</span>,</span><br><span class="line">        xmlMode: <span class="literal">false</span>,</span><br><span class="line">        lowerCaseTags: <span class="literal">false</span>,</span><br><span class="line">        decodeEntities: <span class="literal">false</span></span><br><span class="line">      &#125;);</span><br><span class="line"></span><br><span class="line">      $(<span class="string">'img'</span>).each(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span> ($(<span class="keyword">this</span>).attr(<span class="string">'src'</span>))&#123;</span><br><span class="line">            <span class="comment">// For windows style path, we replace '\' to '/'.</span></span><br><span class="line">            <span class="keyword">var</span> src = $(<span class="keyword">this</span>).attr(<span class="string">'src'</span>).replace(<span class="string">'\\'</span>, <span class="string">'/'</span>);</span><br><span class="line">            <span class="keyword">if</span>(!<span class="regexp">/http[s]*.*|\/\/.*/</span>.test(src) &amp;&amp;</span><br><span class="line">               !<span class="regexp">/^\s*\//</span>.test(src)) &#123;</span><br><span class="line">              <span class="comment">// For "about" page, the first part of "src" can't be removed.</span></span><br><span class="line">              <span class="comment">// In addition, to support multi-level local directory.</span></span><br><span class="line">              <span class="keyword">var</span> linkArray = link.split(<span class="string">'/'</span>).filter(<span class="function"><span class="keyword">function</span>(<span class="params">elem</span>)</span>&#123;</span><br><span class="line">                <span class="keyword">return</span> elem != <span class="string">''</span>;</span><br><span class="line">              &#125;);</span><br><span class="line">              <span class="keyword">var</span> srcArray = src.split(<span class="string">'/'</span>).filter(<span class="function"><span class="keyword">function</span>(<span class="params">elem</span>)</span>&#123;</span><br><span class="line">                <span class="keyword">return</span> elem != <span class="string">''</span> &amp;&amp; elem != <span class="string">'.'</span>;</span><br><span class="line">              &#125;);</span><br><span class="line">              <span class="keyword">if</span>(srcArray.length &gt; <span class="number">1</span>)</span><br><span class="line">                srcArray.shift();</span><br><span class="line">              src = srcArray.join(<span class="string">'/'</span>);</span><br><span class="line">              $(<span class="keyword">this</span>).attr(<span class="string">'src'</span>, config.root + link + src);</span><br><span class="line">              <span class="built_in">console</span>.info&amp;&amp;<span class="built_in">console</span>.info(<span class="string">"update link as:--&gt;"</span>+config.root + link + src);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="built_in">console</span>.info&amp;&amp;<span class="built_in">console</span>.info(<span class="string">"no src attr, skipped..."</span>);</span><br><span class="line">            <span class="built_in">console</span>.info&amp;&amp;<span class="built_in">console</span>.info($(<span class="keyword">this</span>));</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;);</span><br><span class="line">      data[key] = $.html();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<ul>
<li>打开根目录配置文件 <code>_config.yml</code> ，修改如下：</li>
</ul>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 文章图片路径转换</span></span><br><span class="line"><span class="attr">post_asset_folder:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure>
<p>重新生成后，会在文章同级目录建立一个同名文件夹，可以存放图片。</p>
<ul>
<li>使用：</li>
</ul>
<figure class="highlight maxima"><table><tr><td class="code"><pre><span class="line">&#123;<span class="symbol">%</span> asset_img <span class="built_in">example</span>.jpg This <span class="built_in">is</span> an <span class="built_in">example</span> <span class="built_in">image</span> <span class="symbol">%</span>&#125;</span><br></pre></td></tr></table></figure>


<blockquote>
<p>参考：<a href="https://blog.csdn.net/xjm850552586/article/details/84101345" target="_blank" rel="noopener">图片引用配置</a></p>
</blockquote>
<h3 id="方式三：存放到根目录"><a href="#方式三：存放到根目录" class="headerlink" title="方式三：存放到根目录"></a>方式三：存放到根目录</h3><ul>
<li>引用：</li>
</ul>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">![<span class="string">描述</span>](<span class="link">/&#123;root&#125;/&#123;图片目录&#125;/你的图片</span>)</span><br><span class="line"><span class="xml"><span class="comment">&lt;!-- e.g. --&gt;</span></span></span><br><span class="line">![<span class="string">issue</span>](<span class="link">/blog/images/gitissue/issue.png</span>)</span><br><span class="line"><span class="xml"><span class="comment">&lt;!-- 使用样式： --&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">""</span> <span class="attr">width</span>=<span class="string">"50%"</span> <span class="attr">height</span>=<span class="string">"50%"</span>&gt;</span></span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>参考：<a href="https://www.zhihu.com/question/23378396" target="_blank" rel="noopener">知乎提问</a></p>
</blockquote>
<h2 id="3-Hexo网站运行时间"><a href="#3-Hexo网站运行时间" class="headerlink" title="3.Hexo网站运行时间"></a>3.Hexo网站运行时间</h2><p>在文件 <code>themes/yelee/layout/_partial/left-col.ejs</code> 中，（具体位置可自选）加入如下代码：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">span</span> <span class="attr">id</span>=<span class="string">"timeDate"</span>&gt;</span>载入天数...<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">id</span>=<span class="string">"times"</span>&gt;</span>载入时分秒...<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> now = <span class="keyword">new</span> <span class="built_in">Date</span>(); </span></span><br><span class="line"><span class="actionscript">    <span class="function"><span class="keyword">function</span> <span class="title">createtime</span><span class="params">()</span> </span>&#123; </span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> grt= <span class="keyword">new</span> <span class="built_in">Date</span>(<span class="string">"11/23/2018 20:00:00"</span>);<span class="comment">//此处修改你的建站时间或者网站上线时间 </span></span></span><br><span class="line">        now.setTime(now.getTime()+250); </span><br><span class="line"><span class="javascript">        days = (now - grt ) / <span class="number">1000</span> / <span class="number">60</span> / <span class="number">60</span> / <span class="number">24</span>; dnum = <span class="built_in">Math</span>.floor(days); </span></span><br><span class="line"><span class="javascript">        hours = (now - grt ) / <span class="number">1000</span> / <span class="number">60</span> / <span class="number">60</span> - (<span class="number">24</span> * dnum); hnum = <span class="built_in">Math</span>.floor(hours); </span></span><br><span class="line"><span class="javascript">        <span class="keyword">if</span>(<span class="built_in">String</span>(hnum).length ==<span class="number">1</span> )&#123;hnum = <span class="string">"0"</span> + hnum;&#125; minutes = (now - grt ) / <span class="number">1000</span> /<span class="number">60</span> - (<span class="number">24</span> * <span class="number">60</span> * dnum) - (<span class="number">60</span> * hnum); </span></span><br><span class="line"><span class="javascript">        mnum = <span class="built_in">Math</span>.floor(minutes); <span class="keyword">if</span>(<span class="built_in">String</span>(mnum).length ==<span class="number">1</span> )&#123;mnum = <span class="string">"0"</span> + mnum;&#125; </span></span><br><span class="line">        seconds = (now - grt ) / 1000 - (24 * 60 * 60 * dnum) - (60 * 60 * hnum) - (60 * mnum); </span><br><span class="line"><span class="javascript">        snum = <span class="built_in">Math</span>.round(seconds); <span class="keyword">if</span>(<span class="built_in">String</span>(snum).length ==<span class="number">1</span> )&#123;snum = <span class="string">"0"</span> + snum;&#125; </span></span><br><span class="line"><span class="javascript">        <span class="built_in">document</span>.getElementById(<span class="string">"timeDate"</span>).innerHTML = <span class="string">"本站已安全运行 "</span>+dnum+<span class="string">" 天 "</span>; </span></span><br><span class="line"><span class="javascript">        <span class="built_in">document</span>.getElementById(<span class="string">"times"</span>).innerHTML = hnum + <span class="string">" 小时 "</span> + mnum + <span class="string">" 分 "</span> + snum + <span class="string">" 秒"</span>; </span></span><br><span class="line">    &#125; </span><br><span class="line"><span class="actionscript">    setInterval(<span class="string">"createtime()"</span>,<span class="number">250</span>);</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>日期格式: 月/日/年 时:分:秒。</p>
</blockquote>
<blockquote>
<p>参考：<a href="https://blog.csdn.net/dta0502/article/details/89607895" target="_blank" rel="noopener">Hexo-Yilia进阶笔记</a></p>
</blockquote>
<h2 id="4-添加心知天气"><a href="#4-添加心知天气" class="headerlink" title="4.添加心知天气"></a>4.添加心知天气</h2><h3 id="4-1-注册账号，设置天气样式："><a href="#4-1-注册账号，设置天气样式：" class="headerlink" title="4.1.注册账号，设置天气样式："></a>4.1.注册账号，设置天气样式：</h3><ul>
<li>进入<a href="https://www.seniverse.com/widgetv3" target="_blank" rel="noopener">官网</a>注册，选择样式：</li>
</ul>
<p><img src="/blog/images/weather/xinzhi-weather.png" alt="心知天气"></p>
<ul>
<li>点击生成代码，复制代码：</li>
</ul>
<p>如：</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&lt;div id=<span class="string">"tp-weather-widget"</span>&gt;&lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">  &lt;script&gt;</span></span><br><span class="line"><span class="regexp">    (function(a,h,g,f,e,d,c,b)&#123;b=function()&#123;d=h.createElement(g);c=h.getElementsByTagName(g)[0];d.src=e;d.charset="utf-8";d.async=1;c.parentNode.insertBefore(d,c)&#125;;a["SeniverseWeatherWidgetObject"]=f;a[f]||(a[f]=function()&#123;(a[f].q=a[f].q||[]).push(arguments)&#125;);a[f].l=+new Date();if(a.attachEvent)&#123;a.attachEvent("onload",b)&#125;else&#123;a.addEventListener("load",b,false)&#125;&#125;(window,document,"script","SeniverseWeatherWidget","/</span><span class="regexp">/cdn.sencdn.com/</span>widget2/<span class="keyword">static</span>/js/bundle.js?t=<span class="string">"+parseInt((new Date().getTime() / 100000000).toString(),10)));</span></span><br><span class="line"><span class="string">    window.SeniverseWeatherWidget('show', &#123;</span></span><br><span class="line"><span class="string">      flavor: "</span>bubble<span class="string">",</span></span><br><span class="line"><span class="string">      location: "</span>WTSQQYHVQ973<span class="string">",</span></span><br><span class="line"><span class="string">      geolocation: true,</span></span><br><span class="line"><span class="string">      language: "</span>zh-Hans<span class="string">",</span></span><br><span class="line"><span class="string">      unit: "</span>c<span class="string">",</span></span><br><span class="line"><span class="string">      theme: "</span>auto<span class="string">",</span></span><br><span class="line"><span class="string">      token: "</span><span class="number">31</span>a8562e-ae28<span class="number">-47</span>fe<span class="number">-860</span>d-d4e01b0867c2<span class="string">",</span></span><br><span class="line"><span class="string">      hover: "</span>enabled<span class="string">",</span></span><br><span class="line"><span class="string">      container: "</span>tp-weather-widget<span class="string">"</span></span><br><span class="line"><span class="string">    &#125;)</span></span><br><span class="line"><span class="string">  &lt;/script&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="4-2-添加配置"><a href="#4-2-添加配置" class="headerlink" title="4.2.添加配置"></a>4.2.添加配置</h3><ul>
<li>打开主题配置文件 <code>_config.yml</code>，添加：</li>
</ul>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 心知天气</span></span><br><span class="line"><span class="attr">xinzhi_weather:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure>
<ul>
<li>打开 <code>themes/yilia-plus/layout/_partial/left-col.ejs</code> 文件，在合适位置添加：</li>
</ul>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">%</span> <span class="attr">if</span>(<span class="attr">theme.xinzhi_weather</span>)&#123; %&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 这是刚刚生成的js代码 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"tp-weather-widget"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">    (<span class="function"><span class="keyword">function</span>(<span class="params">a,h,g,f,e,d,c,b</span>)</span>&#123;b=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;d=h.createElement(g);c=h.getElementsByTagName(g)[<span class="number">0</span>];d.src=e;d.charset=<span class="string">"utf-8"</span>;d.async=<span class="number">1</span>;c.parentNode.insertBefore(d,c)&#125;;a[<span class="string">"SeniverseWeatherWidgetObject"</span>]=f;a[f]||(a[f]=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;(a[f].q=a[f].q||[]).push(<span class="built_in">arguments</span>)&#125;);a[f].l=+<span class="keyword">new</span> <span class="built_in">Date</span>();<span class="keyword">if</span>(a.attachEvent)&#123;a.attachEvent(<span class="string">"onload"</span>,b)&#125;<span class="keyword">else</span>&#123;a.addEventListener(<span class="string">"load"</span>,b,<span class="literal">false</span>)&#125;&#125;(<span class="built_in">window</span>,<span class="built_in">document</span>,<span class="string">"script"</span>,<span class="string">"SeniverseWeatherWidget"</span>,<span class="string">"//cdn.sencdn.com/widget2/static/js/bundle.js?t="</span>+<span class="built_in">parseInt</span>((<span class="keyword">new</span> <span class="built_in">Date</span>().getTime() / <span class="number">100000000</span>).toString(),<span class="number">10</span>)));</span></span><br><span class="line"><span class="javascript">    <span class="built_in">window</span>.SeniverseWeatherWidget(<span class="string">'show'</span>, &#123;</span></span><br><span class="line"><span class="actionscript">      flavor: <span class="string">"bubble"</span>,</span></span><br><span class="line"><span class="actionscript">      location: <span class="string">"WTSQQYHVQ973"</span>,</span></span><br><span class="line"><span class="actionscript">      geolocation: <span class="literal">true</span>,</span></span><br><span class="line"><span class="actionscript">      language: <span class="string">"zh-Hans"</span>,</span></span><br><span class="line"><span class="actionscript">      unit: <span class="string">"c"</span>,</span></span><br><span class="line"><span class="actionscript">      theme: <span class="string">"auto"</span>,</span></span><br><span class="line"><span class="actionscript">      token: <span class="string">"31a8562e-ae28-47fe-860d-d4e01b0867c2"</span>,</span></span><br><span class="line"><span class="actionscript">      hover: <span class="string">"enabled"</span>,</span></span><br><span class="line"><span class="actionscript">      container: <span class="string">"tp-weather-widget"</span></span></span><br><span class="line">    &#125;)</span><br><span class="line">  <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">%</span> &#125; %&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>参考：<a href="https://blog.csdn.net/weixin_41287260/article/details/103050663" target="_blank" rel="noopener">添加天气</a></p>
</blockquote>
<h2 id="5-添加百度推送"><a href="#5-添加百度推送" class="headerlink" title="5.添加百度推送"></a>5.添加百度推送</h2><h3 id="5-1-新建-baidu-push-ejs-文件"><a href="#5-1-新建-baidu-push-ejs-文件" class="headerlink" title="5.1.新建 baidu-push.ejs 文件"></a>5.1.新建 <code>baidu-push.ejs</code> 文件</h3><p>在 <code>yilia-plus/layout/_partial</code> 下添加 <code>baidu-push.ejs</code> 文件，内容如下：</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&lt;% <span class="keyword">if</span> (theme.baidu_push)&#123; %&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> bp = <span class="built_in">document</span>.createElement(<span class="string">'script'</span>);</span><br><span class="line">    <span class="keyword">var</span> curProtocol = <span class="built_in">window</span>.location.protocol.split(<span class="string">':'</span>)[<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">if</span> (curProtocol === <span class="string">'https'</span>) &#123;</span><br><span class="line">        bp.src = <span class="string">'https://zz.bdstatic.com/linksubmit/push.js'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        bp.src = <span class="string">'http://push.zhanzhang.baidu.com/push.js'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> s = <span class="built_in">document</span>.getElementsByTagName(<span class="string">"script"</span>)[<span class="number">0</span>];</span><br><span class="line">    s.parentNode.insertBefore(bp, s);</span><br><span class="line">&#125;)();</span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br><span class="line"><span class="regexp">&lt;% &#125; %&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="5-2-引用-baidu-push-ejs"><a href="#5-2-引用-baidu-push-ejs" class="headerlink" title="5.2.引用 baidu-push.ejs"></a>5.2.引用 <code>baidu-push.ejs</code></h3><p>编辑 <code>layout/_partial/head.ejs</code>，添加：</p>
<figure class="highlight gcode"><table><tr><td class="code"><pre><span class="line">&lt;<span class="meta">%</span>- partial<span class="comment">('baidu-push')</span> <span class="meta">%</span>&gt;</span><br></pre></td></tr></table></figure>

<h3 id="5-3-添加-baidu-push-属性"><a href="#5-3-添加-baidu-push-属性" class="headerlink" title="5.3. 添加 baidu_push 属性"></a>5.3. 添加 <code>baidu_push</code> 属性</h3><p>编辑 <code>yilia/_config.yml</code> ，添加：</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 百度推送</span></span><br><span class="line"><span class="attr">baidu_push:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure>

<h2 id="6-添加版权声明"><a href="#6-添加版权声明" class="headerlink" title="6.添加版权声明"></a>6.添加版权声明</h2><ul>
<li>在 <code>layout/_partial/head.ejs</code> 或 <code>layout/_partial/aricle.ejs</code> 中合适位置，添加：</li>
</ul>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">%</span> <span class="attr">if</span> (((<span class="attr">theme.copyright_type</span> === <span class="string">2)</span> || (<span class="attr">theme.copyright_type</span> === <span class="string">1</span> &amp;&amp; <span class="attr">post.copyright</span>)) &amp;&amp; !<span class="attr">index</span>)&#123; %&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"declare"</span>&gt;</span> </span><br><span class="line">      <span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">"post-copyright"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">strong</span>&gt;</span>本文作者：<span class="tag">&lt;/<span class="name">strong</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">%=</span> <span class="attr">config.author</span>%&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">strong</span>&gt;</span>本文链接：<span class="tag">&lt;/<span class="name">strong</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"&lt;%- yilia_plus_full_url(post.path) %&gt;"</span> <span class="attr">title</span>=<span class="string">"&lt;%= post.title %&gt;"</span> <span class="attr">target</span>=<span class="string">"_blank"</span>&gt;</span><span class="tag">&lt;<span class="name">%-</span> <span class="attr">yilia_plus_full_url</span>(<span class="attr">post.path</span>) %&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">%</span> <span class="attr">if</span> (<span class="attr">theme.copyright_text</span> || <span class="attr">theme.copyright_text</span> == <span class="string">null)&#123;</span> %&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">strong</span>&gt;</span>版权声明： <span class="tag">&lt;/<span class="name">strong</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">%</span> <span class="attr">var</span> <span class="attr">defaultCopyrightText</span> = <span class="string">'本博客所有文章除特别声明外，均采用 &lt;a href="https://github.com/JoeyBling/hexo-theme-yilia-plus/blob/master/LICENSE" rel="external nofollow" target="_blank"&gt;MIT&lt;/a&gt; 许可协议。转载请注明出处！'</span>; %&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">%-</span> ( <span class="attr">theme.copyright_text</span> == <span class="string">null</span> || <span class="attr">theme.copyright_text</span> == <span class="string">true</span> ) ? <span class="attr">defaultCopyrightText</span> <span class="attr">:</span> <span class="attr">theme.copyright_text</span> %&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">%</span> &#125; %&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">%</span> &#125; %&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>打开样式文件 <code>themes\yilia-plus\source\main.b8fa34.css</code> ，添加样式：</li>
</ul>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.post-copyright</span>&#123;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">0em</span> <span class="number">0em</span> <span class="number">0em</span> <span class="number">0em</span>;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">0.5em</span> <span class="number">1em</span>;</span><br><span class="line">    <span class="attribute">border-left</span>:<span class="number">3px</span> solid <span class="number">#ff1700</span>;</span><br><span class="line">    <span class="attribute">background-color</span>: <span class="number">#f9f9f9</span>;</span><br><span class="line">    <span class="attribute">list-style</span>: none;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">14px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>添加 <code>copyright_type</code> 属性</li>
</ul>
<p>打开主题配置文件 <code>_config.yml</code>，添加：</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 版权声明</span></span><br><span class="line"><span class="comment"># type：0-关闭版权声明； 1-存在copyright:true属性的文章，显示版权声明； 2-所有文章均有版权声明</span></span><br><span class="line"><span class="attr">copyright_type:</span> <span class="number">0</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>参考：<a href="https://blog.csdn.net/weixin_30391339/article/details/98582169" target="_blank" rel="noopener">Yilia主题优化</a></p>
</blockquote>
<h2 id="7-添加在线聊天"><a href="#7-添加在线聊天" class="headerlink" title="7.添加在线聊天"></a>7.添加在线聊天</h2><h3 id="7-1-注册"><a href="#7-1-注册" class="headerlink" title="7.1.注册"></a>7.1.注册</h3><h4 id="去官网注册一个账号，复制我的邀请码eb35ef31，然后直接点击开始注册："><a href="#去官网注册一个账号，复制我的邀请码eb35ef31，然后直接点击开始注册：" class="headerlink" title="去官网注册一个账号，复制我的邀请码eb35ef31，然后直接点击开始注册："></a>去<a href="http://www.daovoice.io/" target="_blank" rel="noopener">官网</a>注册一个账号，复制我的邀请码<a href="http://dashboard.daovoice.io/get-started" target="_blank" rel="noopener">eb35ef31</a>，然后直接点击开始注册：</h4><div align="center">
  <img src="/blog/images/daovoice/daovoice_register.png" width="50%">
</div>

<h4 id="完成后，显示如下界面："><a href="#完成后，显示如下界面：" class="headerlink" title="完成后，显示如下界面："></a>完成后，显示如下界面：</h4><div align="center">
  <img src="/blog/images/daovoice/daovoice_config.png" width="75%">
</div>

<p>可以通过点击 <strong><code>点击接入</code></strong> ，或路径 <strong><code>[应用设置]</code></strong> -&gt; <strong><code>[安装到网站]</code></strong> 找到。</p>
<h4 id="可以修改喜欢的样式"><a href="#可以修改喜欢的样式" class="headerlink" title="可以修改喜欢的样式"></a>可以修改喜欢的样式</h4><p>找到 <strong><code>[应用设置]</code></strong> -&gt; <strong><code>[聊天设置]</code></strong>，修改 :</p>
<div align="center">
  <img src="/blog/images/daovoice/daovoice_style.png" width="75%">
</div>

<p>接下来有提示，复制框1、3中的代码到head文件中，放在 <code>&lt;/head&gt;</code> 标签之前。</p>
<h3 id="7-2-在文件-head-ejs-中添加配置"><a href="#7-2-在文件-head-ejs-中添加配置" class="headerlink" title="7.2.在文件 head.ejs 中添加配置"></a>7.2.在文件 <code>head.ejs</code> 中添加配置</h3><p>打开文件 <code>themes\yilia-plus\layout\_partial\head.ejs</code>，添加：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">%#</span> "在线聊天" %&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">%</span> <span class="attr">if</span> (<span class="attr">theme.daovoice</span>) &#123; %&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">    (<span class="function"><span class="keyword">function</span>(<span class="params">i,s,o,g,r,a,m</span>)</span>&#123;i[<span class="string">"DaoVoiceObject"</span>]=r;i[r]=i[r]||<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;(i[r].q=i[r].q||[]).push(<span class="built_in">arguments</span>)&#125;,i[r].l=<span class="number">1</span>*<span class="keyword">new</span> <span class="built_in">Date</span>();a=s.createElement(o),m=s.getElementsByTagName(o)[<span class="number">0</span>];a.async=<span class="number">1</span>;a.src=g;a.charset=<span class="string">"utf-8"</span>;m.parentNode.insertBefore(a,m)&#125;)(<span class="built_in">window</span>,<span class="built_in">document</span>,<span class="string">"script"</span>,(<span class="string">'https:'</span> == <span class="built_in">document</span>.location.protocol ? <span class="string">'https:'</span> : <span class="string">'http:'</span>) + <span class="string">"//widget.daovoice.io/widget/&lt;%= theme.daovoice_app_id %&gt;.js"</span>,<span class="string">"daovoice"</span>)</span></span><br><span class="line"></span><br><span class="line"><span class="actionscript">    daovoice(<span class="string">'init'</span>, &#123;</span></span><br><span class="line"><span class="actionscript">      app_id: <span class="string">"&lt;%= theme.daovoice_app_id %&gt;"</span></span></span><br><span class="line">    &#125;);</span><br><span class="line"><span class="actionscript">    daovoice(<span class="string">'update'</span>);</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">%</span> &#125; %&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="7-3-配置参数"><a href="#7-3-配置参数" class="headerlink" title="7.3.配置参数"></a>7.3.配置参数</h3><p>在主题配置文件 <code>_config.yml</code> 中，添加：</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Daovoice DaoCloud 在线沟通</span></span><br><span class="line"><span class="attr">daovoice:</span> <span class="literal">true</span> </span><br><span class="line"><span class="attr">daovoice_app_id:</span> <span class="string">""</span>   <span class="comment"># 填你的id</span></span><br></pre></td></tr></table></figure>


<hr>
]]></content>
      <categories>
        <category>网站</category>
        <category>Hexo</category>
      </categories>
      <tags>
        <tag>yilia</tag>
        <tag>插件</tag>
      </tags>
  </entry>
  <entry>
    <title>Hexo搭建个人博客：yilia主题配置(四) - 分类管理</title>
    <url>/blog/archives/46241.html</url>
    <content><![CDATA[<p>本文主要讲述 <code>Hexo-yilia</code> 主题对于文章的分类和标签方面的配置。</p>
<a id="more"></a>

<h2 id="1-插件安装"><a href="#1-插件安装" class="headerlink" title="1.插件安装"></a>1.插件安装</h2><blockquote>
<p>安装云标签：</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm install hexo-tag-cloud@^2.0.* --save</span><br></pre></td></tr></table></figure>

<h2 id="2-基本配置"><a href="#2-基本配置" class="headerlink" title="2.基本配置"></a>2.基本配置</h2><p>在主题配置文件 <code>_config.yml</code> 中，添加：</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">menu:</span></span><br><span class="line">  <span class="string">主页:</span> <span class="string">/</span></span><br><span class="line">  <span class="string">标签:</span> <span class="string">/tags</span></span><br><span class="line">  <span class="string">分类:</span> <span class="string">/categories</span></span><br></pre></td></tr></table></figure>

<h2 id="3-构建"><a href="#3-构建" class="headerlink" title="3. 构建"></a>3. 构建</h2><h3 id="3-1-分类"><a href="#3-1-分类" class="headerlink" title="3.1.分类"></a>3.1.分类</h3><ul>
<li>打开 <code>DOS</code> 窗口或 <code>git bash</code>，输入以下命令：</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hexo new page <span class="string">'categories'</span></span><br></pre></td></tr></table></figure>
<ul>
<li>打开 <code>source\categories\index.md</code> 文件，修改如下：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">---</span><br><span class="line">title: 分类</span><br><span class="line">date: 2020-02-14 22:18:16</span><br><span class="line">type: categories</span><br><span class="line">layout: &quot;categories&quot;</span><br><span class="line">toc: false</span><br><span class="line">comments: false</span><br><span class="line">---</span><br></pre></td></tr></table></figure>

<h3 id="3-2-标签"><a href="#3-2-标签" class="headerlink" title="3.2.标签"></a>3.2.标签</h3><ul>
<li>同样，输入：</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hexo new page <span class="string">'tags'</span></span><br></pre></td></tr></table></figure>
<ul>
<li>打开 <code>source\tags\index.md</code> 文件，修改如下：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">---</span><br><span class="line">title: 标签</span><br><span class="line">date: 2020-02-14 22:20:43</span><br><span class="line">type: tags</span><br><span class="line">layout: &quot;tags&quot;</span><br><span class="line">comments: false</span><br><span class="line">---</span><br></pre></td></tr></table></figure>

<h2 id="4-页面配置"><a href="#4-页面配置" class="headerlink" title="4.页面配置"></a>4.页面配置</h2><ul>
<li>打开 <code>scaffolds/</code> 目录下的 <code>post.md</code> 文件，添加：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">toc: true   </span><br><span class="line">tags: &#123;&#123; tags &#125;&#125;</span><br><span class="line">categories:</span><br></pre></td></tr></table></figure>

<h3 id="方式一：组合配置"><a href="#方式一：组合配置" class="headerlink" title="方式一：组合配置"></a>方式一：组合配置</h3><p>在文件 <code>themes\yilia-plus\layout\_partial\article.ejs</code> 中，找到 <code>class=&quot;article-entry&quot;</code>，添加：</p>
<figure class="highlight erb"><table><tr><td class="code"><pre><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">%</span></span></span><span class="ruby"> <span class="keyword">if</span> (page.path === <span class="string">"tags/index.html"</span>)&#123; </span><span class="xml"><span class="tag">%&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">hr</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">br</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">%-</span></span></span><span class="ruby"> list_categories(&#123;</span></span><br><span class="line"><span class="ruby">        <span class="symbol">depth:</span> <span class="number">1</span>,</span></span><br><span class="line"><span class="ruby">    &#125;) </span><span class="xml">%&gt;</span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"tags"</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">%-</span></span></span><span class="ruby"> tagcloud(&#123;</span></span><br><span class="line"><span class="ruby">            <span class="symbol">min_font:</span> <span class="number">16</span>, </span></span><br><span class="line"><span class="ruby">            <span class="symbol">max_font:</span> <span class="number">35</span>, </span></span><br><span class="line"><span class="ruby">            <span class="symbol">amount:</span> <span class="number">999</span>, </span></span><br><span class="line"><span class="ruby">            <span class="symbol">color:</span> <span class="literal">true</span>, </span></span><br><span class="line"><span class="ruby">            <span class="symbol">start_color:</span> <span class="string">'blue'</span>, </span></span><br><span class="line"><span class="ruby">            <span class="symbol">end_color:</span> <span class="string">'gray'</span>,</span></span><br><span class="line"><span class="ruby">        &#125;) </span><span class="xml">%&gt;</span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">style</span>&gt;</span></span></span><br><span class="line"><span class="xml">        .category-list li&#123;</span></span><br><span class="line"><span class="xml">            display: inline-block;</span></span><br><span class="line"><span class="xml">            margin: 0 1em .5em 0;</span></span><br><span class="line"><span class="xml">            padding: 4px;</span></span><br><span class="line"><span class="xml">            border: 1px solid green;</span></span><br><span class="line"><span class="xml">            font-size: 1.2em;</span></span><br><span class="line"><span class="xml">        &#125;</span></span><br><span class="line"><span class="xml">        .category-list a &#123;</span></span><br><span class="line"><span class="xml">            color: #ffffff;</span></span><br><span class="line"><span class="xml">        &#125;</span></span><br><span class="line"><span class="xml">        .category-list-item &#123;</span></span><br><span class="line"><span class="xml">          background-color: #55daff;</span></span><br><span class="line"><span class="xml">          border-radius: 15%;</span></span><br><span class="line"><span class="xml">          opacity:0.5; </span></span><br><span class="line"><span class="xml">        &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="xml">        .category-list-item:hover a &#123;</span></span><br><span class="line"><span class="xml">            color: #c16431;</span></span><br><span class="line"><span class="xml">            text-decoration: none;</span></span><br><span class="line"><span class="xml">            font-weight: bold;</span></span><br><span class="line"><span class="xml">        &#125;</span></span><br><span class="line"><span class="xml">        .category-list-count &#123;</span></span><br><span class="line"><span class="xml">            margin-left: 2px;</span></span><br><span class="line"><span class="xml">            font-size: .9em;</span></span><br><span class="line"><span class="xml">        &#125;</span></span><br><span class="line"><span class="xml">        .article-entry ul li:before&#123;</span></span><br><span class="line"><span class="xml">            display: none;</span></span><br><span class="line"><span class="xml">        &#125;</span></span><br><span class="line"><span class="xml">        </span></span><br><span class="line"><span class="xml">        .tags &#123;</span></span><br><span class="line"><span class="xml">            max-width: 40em;</span></span><br><span class="line"><span class="xml">            margin: 2em auto;</span></span><br><span class="line"><span class="xml">            margin-top: 0em;</span></span><br><span class="line"><span class="xml">        &#125;</span></span><br><span class="line"><span class="xml">        .tags a &#123;</span></span><br><span class="line"><span class="xml">            margin-right: 1em;</span></span><br><span class="line"><span class="xml">            border-bottom: 1px solid blue;</span></span><br><span class="line"><span class="xml">            line-height: 65px;</span></span><br><span class="line"><span class="xml">            white-space: nowrap;</span></span><br><span class="line"><span class="xml">        &#125;</span></span><br><span class="line"><span class="xml">        .tags a:hover &#123;</span></span><br><span class="line"><span class="xml">            border-bottom: 2px solid green;</span></span><br><span class="line"><span class="xml">            font-style: italic;</span></span><br><span class="line"><span class="xml">            color: #22323a;</span></span><br><span class="line"><span class="xml">            text-decoration: none;</span></span><br><span class="line"><span class="xml">        &#125;</span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">style</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">%</span></span></span><span class="ruby"> &#125; </span><span class="xml"><span class="tag">%&gt;</span></span></span><br></pre></td></tr></table></figure>

<h3 id="方式二：分开布局"><a href="#方式二：分开布局" class="headerlink" title="方式二：分开布局"></a>方式二：分开布局</h3><p>在文件 <code>themes\yilia-plus\layout\_partial\article.ejs</code> 中，找到 <code>class=&quot;article-entry&quot;</code>，添加：</p>
<figure class="highlight applescript"><table><tr><td class="code"><pre><span class="line">&lt;% <span class="keyword">if</span> (page.type === <span class="string">"tags"</span>) &#123; %&gt;</span><br><span class="line">  &lt;<span class="keyword">div</span> <span class="built_in">class</span>=<span class="string">"tag-cloud"</span>&gt;</span><br><span class="line">    &lt;<span class="keyword">div</span> <span class="built_in">class</span>=<span class="string">"tag-cloud-title"</span>&gt;</span><br><span class="line">    &lt;%- <span class="string">"TOTAl : "</span> + site.tags.<span class="built_in">length</span> %&gt;</span><br><span class="line">    &lt;/<span class="keyword">div</span>&gt;</span><br><span class="line"> </span><br><span class="line">    &lt;<span class="keyword">div</span> <span class="built_in">class</span>=<span class="string">"tag-cloud-tags"</span>&gt;</span><br><span class="line">    &lt;%- tagcloud(&#123;</span><br><span class="line">      min_font: <span class="number">12</span>,</span><br><span class="line">      max_font: <span class="number">30</span>,</span><br><span class="line">      amount: <span class="number">200</span>,</span><br><span class="line">      color: <span class="literal">true</span>,</span><br><span class="line">      start_color: '<span class="comment">#555',</span></span><br><span class="line">      end_color: '<span class="comment">#111'</span></span><br><span class="line">      &#125;) %&gt;</span><br><span class="line">    &lt;/<span class="keyword">div</span>&gt;</span><br><span class="line">  &lt;/<span class="keyword">div</span>&gt;</span><br><span class="line"> </span><br><span class="line">  &lt;% &#125; <span class="keyword">else</span> <span class="keyword">if</span> (page.type === 'categories') &#123; %&gt;</span><br><span class="line"> </span><br><span class="line">  &lt;<span class="keyword">div</span> <span class="built_in">class</span>=<span class="string">"category-all-page"</span>&gt;</span><br><span class="line">    &lt;<span class="keyword">div</span> <span class="built_in">class</span>=<span class="string">"category-all-title"</span>&gt;</span><br><span class="line">    &lt;%- <span class="string">"TOTAL : "</span> + site.categories.<span class="built_in">length</span> %&gt;</span><br><span class="line">    &lt;/<span class="keyword">div</span>&gt;</span><br><span class="line"> </span><br><span class="line">    &lt;<span class="keyword">div</span> <span class="built_in">class</span>=<span class="string">"category-all"</span>&gt;</span><br><span class="line">    &lt;%- list_categories() %&gt;</span><br><span class="line">    &lt;/<span class="keyword">div</span>&gt;</span><br><span class="line"> </span><br><span class="line">  &lt;/<span class="keyword">div</span>&gt;</span><br><span class="line">&lt;% &#125; %&gt;</span><br></pre></td></tr></table></figure>

<p>在样式文件 <code>themes\yilia-plus\source\main.b8fa34.css</code> 中，添加：</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.category-all-page</span> &#123;</span><br><span class="line">  <span class="attribute">a</span>:link &#123;</span><br><span class="line">    font-size: <span class="number">14px</span>;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#333</span>;</span><br><span class="line">    <span class="attribute">text-decoration</span>: none;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-tag">a</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">14px</span>;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#d8d</span>;</span><br><span class="line">    <span class="attribute">text-decoration</span>: none;</span><br><span class="line">    <span class="attribute">font-weight</span>: bold;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-class">.category-all-title</span> &#123; <span class="attribute">text-align</span>: left; &#125;</span><br><span class="line"> </span><br><span class="line">  <span class="selector-class">.category-all</span> &#123; </span><br><span class="line">    <span class="attribute">margin-top</span>: <span class="number">20px</span>; </span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  <span class="selector-class">.category-list</span> &#123;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">list-style</span>: none;</span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  <span class="selector-class">.category-list-item</span> &#123; </span><br><span class="line">    <span class="attribute">text-align</span>: center;</span><br><span class="line">    <span class="attribute">display</span>: inline-block;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">8px</span>; </span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">8px</span>;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">150px</span>;</span><br><span class="line">    <span class="attribute">position</span>: relative;</span><br><span class="line">    <span class="attribute">background-color</span>: <span class="built_in">rgba</span>(<span class="number">237</span>, <span class="number">237</span>, <span class="number">237</span>, <span class="number">0.53</span>);</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">1px</span>;</span><br><span class="line">    <span class="attribute">box-shadow</span>:<span class="number">0px</span> <span class="number">0px</span>  <span class="number">0px</span> <span class="number">1px</span> <span class="number">#ccc</span>;</span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  <span class="selector-class">.category-list-link</span> &#123;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#333</span>;</span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  <span class="selector-class">.category-list-count</span> &#123;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#333</span>;</span><br><span class="line">    &amp;:before &#123;</span><br><span class="line">      <span class="selector-tag">display</span>: <span class="selector-tag">inline</span>;</span><br><span class="line">      <span class="selector-tag">content</span>: " ("</span><br><span class="line">    &#125;</span><br><span class="line">    &amp;<span class="selector-pseudo">:after</span> &#123;</span><br><span class="line">      <span class="attribute">display</span>: inline;</span><br><span class="line">      <span class="attribute">content</span>: <span class="string">") "</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  <span class="selector-class">.category-list-child</span> &#123; <span class="attribute">padding-left</span>: <span class="number">10px</span>; <span class="attribute">color</span>: <span class="number">#333</span>;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<hr>
]]></content>
      <categories>
        <category>网站</category>
        <category>Hexo</category>
      </categories>
      <tags>
        <tag>yilia</tag>
        <tag>标签分类</tag>
      </tags>
  </entry>
  <entry>
    <title>Hexo搭建个人博客：yilia主题配置(三) - 评论系统</title>
    <url>/blog/archives/37394.html</url>
    <content><![CDATA[<p>本文主要是关于 <code>评论系统</code> 在 <code>hexo-yilia</code> 主题中的添加和配置。使用主题： <a href="https://github.com/JoeyBling/hexo-theme-yilia-plus" target="_blank" rel="noopener">hexo-theme-yilia-plus</a></p>
<a id="more"></a>

<h2 id="常用系统"><a href="#常用系统" class="headerlink" title="常用系统"></a>常用系统</h2><p>目前hexo可用的评论系统比较多，如：畅言、来必力、Disqus、Gitment、gitalk、utterances、Giteement、valine等等。不过有些已关停服务。</p>
<p>这里列举五个hexo常用的评论系统：</p>
<ul>
<li><strong>1、<a href="#1-Gitment配置" target="_self">gitment</a></strong> ：基于GitHub issue的评论系统，可参考：<a href="https://www.jianshu.com/p/ac7658cc912f" target="_blank" rel="noopener">简书</a>；</li>
<li><strong>2、<a href="#2-Gitalk配置" target="_self">gitalk</a></strong> : 基于GitHub issue的评论系统，可参考：<a href="https://github.com/gitalk/gitalk" target="_blank" rel="noopener">gitalk</a>；</li>
<li><strong>3、<a href="#3-Utterance配置" target="_self">utterance</a></strong> : 基于GitHub issue的评论系统，可参考：<a href="https://utteranc.es" target="_blank" rel="noopener">详情</a></li>
<li><strong>4、<a href="#4-Giteement配置" target="_self">giteement</a></strong> : 码云评论系统，国内用户建议使用这个，相对比较快，<a href="https://gitee.com/zhousiwei/giteement" target="_blank" rel="noopener">详情</a>；</li>
<li><strong>5、<a href="#5-Valine配置" target="_self">valine</a></strong> : valine 评论系统，到 <a href="https://leancloud.cn/dashboard/login.html#/signup" target="_blank" rel="noopener">leancloud</a> 进行注册。</li>
</ul>
<h2 id="1-Gitment配置"><a href="#1-Gitment配置" class="headerlink" title="1.Gitment配置"></a>1.Gitment配置</h2><blockquote>
<p>首先要注册 <a href="https://github.com/settings/applications/new" target="_blank" rel="noopener">OAuth Application</a> 当别人评论你的文章时，会需要它是授权。</p>
</blockquote>
<br>
<!-- ![OAuth](/images/gitissue/oauth.png) -->
<div align="center">
  <img src="/blog/images/gitissue/oauth.png" width="400px">
</div>

<p>注册成功后，会获取到 <code>Client ID/scerct</code> ，需要填入配置文件中。</p>
<p>打开文件 <code>themes\yilia-plus\_config.yml</code> , 修改配置：</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">gitment_owner:</span> <span class="string">''</span>      <span class="comment"># 你的 GitHub ID (github 账户名)</span></span><br><span class="line"><span class="comment"># 是否使用官方js(false可以提升访问速度，本地修改过一部分的js，官方js可能会出现服务器不稳定，不太建议使用)</span></span><br><span class="line"><span class="attr">gitment_repo:</span> <span class="string">'如：xxx.github.io'</span>  <span class="comment">#存储评论的 repo name(需要在Github创建)</span></span><br><span class="line"><span class="attr">gitment_oauth:</span></span><br><span class="line">  <span class="attr">client_id:</span> <span class="string">''</span>           <span class="comment">#client ID</span></span><br><span class="line">  <span class="attr">client_secret:</span> <span class="string">''</span>       <span class="comment">#client secret</span></span><br></pre></td></tr></table></figure>

<p>在 <code>themes\yilia-plus\layout\_partial\post</code> 目录下，会默认有一个 <code>gitment.ejs</code> 文件，可以自定义样式<br>对应的 <code>themes\yilia-plus\layout\_partial\article.ejs</code> 文件，会有 <code>gitment</code> 相关的配置。</p>
<h2 id="2-Gitalk配置"><a href="#2-Gitalk配置" class="headerlink" title="2.Gitalk配置"></a>2.Gitalk配置</h2><h3 id="2-1-新建-gitalk-ejs-文件"><a href="#2-1-新建-gitalk-ejs-文件" class="headerlink" title="2.1.新建 gitalk.ejs 文件"></a>2.1.新建 <code>gitalk.ejs</code> 文件</h3><p>与 <code>gitment</code> 类似配置，首先在 <code>themes\yilia-plus\layout\_partial\post</code> 目录下，新建 <code>gitalk.ejs</code> 文件，<br>添加如下内容：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"gitalk-container"</span> <span class="attr">style</span>=<span class="string">"padding: 0px 30px 0px 30px;"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span> </span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">href</span>=<span class="string">"https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="handlebars"><span class="xml">if(<span class="tag">&lt;<span class="name">%=theme.gitalk.enable%</span>&gt;</span>)&#123;</span></span></span><br><span class="line"><span class="actionscript">    <span class="keyword">var</span> gitalk = <span class="keyword">new</span> Gitalk(&#123;</span></span><br><span class="line"><span class="actionscript">    clientID: <span class="string">'&lt;%=theme.gitalk.ClientID%&gt;'</span>,</span></span><br><span class="line"><span class="actionscript">    clientSecret: <span class="string">'&lt;%=theme.gitalk.ClientSecret%&gt;'</span>,</span></span><br><span class="line"><span class="actionscript">    repo: <span class="string">'&lt;%=theme.gitalk.repo%&gt;'</span>,</span></span><br><span class="line"><span class="actionscript">    owner: <span class="string">'&lt;%=theme.gitalk.githubID%&gt;'</span>,</span></span><br><span class="line"><span class="actionscript">    admin: [<span class="string">'&lt;%=theme.gitalk.adminUser%&gt;'</span>],</span></span><br><span class="line"><span class="actionscript">    id: <span class="string">'&lt;%= page.date %&gt;'</span>,</span></span><br><span class="line"><span class="actionscript">    distractionFreeMode: <span class="string">'&lt;%=theme.gitalk.distractionFreeMode%&gt;'</span></span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="actionscript">gitalk.render(<span class="string">'gitalk-container'</span>) </span></span><br><span class="line">&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="2-2-修改文件-comment-scss"><a href="#2-2-修改文件-comment-scss" class="headerlink" title="2.2.修改文件 comment.scss"></a>2.2.修改文件 <code>comment.scss</code></h3><p>在文件 <code>themes\yilia\source-src\css\comment.scss</code> 中，做如下修改：</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-id">#disqus_thread</span>, <span class="selector-class">.duoshuo</span>, <span class="selector-class">.cloud-tie-wrapper</span>, <span class="selector-id">#SOHUCS</span>, <span class="selector-id">#gitment-ctn</span>, <span class="selector-id">#gitalk-container</span> &#123;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">0</span> <span class="number">30px</span> <span class="meta">!important</span>;</span><br><span class="line">    <span class="attribute">min-height</span>: <span class="number">20px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#SOHUCS</span> &#123;</span><br><span class="line">    #SOHU_MAIN .module-cmt-list .block-cont-gw &#123;</span><br><span class="line">        <span class="selector-tag">border-bottom</span>: 1<span class="selector-tag">px</span> <span class="selector-tag">dashed</span> <span class="selector-id">#c8c8c8</span> !<span class="selector-tag">important</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="2-3-修改主题配置文件-config-yml"><a href="#2-3-修改主题配置文件-config-yml" class="headerlink" title="2.3.修改主题配置文件 _config.yml"></a>2.3.修改主题配置文件 <code>_config.yml</code></h3><p>打开文件 <code>themes\yilia-plus\_config.yml</code> , 修改配置：</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">gitalk:</span></span><br><span class="line">  <span class="attr">enable:</span>  <span class="literal">true</span></span><br><span class="line">  <span class="attr">githubID:</span>  <span class="string">''</span>      <span class="comment"># 写自己github的ID</span></span><br><span class="line">  <span class="attr">repo:</span>  <span class="string">''</span>          <span class="comment"># 新建存放评论的仓库名</span></span><br><span class="line">  <span class="attr">ClientID:</span>  <span class="string">''</span>      <span class="comment"># 与 `gitment` 一样</span></span><br><span class="line">  <span class="attr">ClientSecret:</span>  <span class="string">''</span>  <span class="comment"># 同上</span></span><br><span class="line">  <span class="attr">adminUser:</span>  <span class="string">''</span>     <span class="comment"># 也填GitHub的ID</span></span><br><span class="line">  <span class="attr">distractionFreeMode:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure>

<h3 id="2-4-在文件-article-ejs-中添加配置"><a href="#2-4-在文件-article-ejs-中添加配置" class="headerlink" title="2.4.在文件 article.ejs 中添加配置"></a>2.4.在文件 <code>article.ejs</code> 中添加配置</h3><p>打开 <code>themes\yilia-plus\layout\_partial\article.ejs</code> 文件，添加：</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&lt;% <span class="keyword">if</span>(theme.gitalk.enable)&#123; %&gt;</span><br><span class="line">  &lt;%- partial(<span class="string">'post/gitalk'</span>, &#123;</span><br><span class="line">      key: post.slug,</span><br><span class="line">      title: post.title,</span><br><span class="line">      url: config.url+url_for(post.path)</span><br><span class="line">    &#125;) %&gt;</span><br><span class="line">  &lt;% &#125; %&gt;</span><br></pre></td></tr></table></figure>

<h2 id="3-Utterance配置"><a href="#3-Utterance配置" class="headerlink" title="3.Utterance配置"></a>3.Utterance配置</h2><h3 id="3-1-授权Utterance应用能访问仓库的issues"><a href="#3-1-授权Utterance应用能访问仓库的issues" class="headerlink" title="3.1.授权Utterance应用能访问仓库的issues"></a>3.1.授权Utterance应用能访问仓库的issues</h3><p>即安装 <code>Utterance</code> 应用，点击 <a href="https://github.com/apps/utterances" target="_blank" rel="noopener">install utterances</a>，选择需要安装的仓库。</p>
<h3 id="3-2-fork项目"><a href="#3-2-fork项目" class="headerlink" title="3.2.fork项目"></a>3.2.fork项目</h3><p>去 <code>GitHub</code> 上 fork <a href="https://github.com/utterance/utterances" target="_blank" rel="noopener">Utterance</a>项目，按照它的教程在 <strong><code>SITES.md</code></strong> 文件中注册你的博客网址，否则可能会配置失败。</p>
<h3 id="3-3-修改主题配置文件-config-yml"><a href="#3-3-修改主题配置文件-config-yml" class="headerlink" title="3.3.修改主题配置文件 _config.yml"></a>3.3.修改主题配置文件 <code>_config.yml</code></h3><p>打开文件 <code>themes\yilia-plus\_config.yml</code> , 修改配置：</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># utteranc评论： https://utteranc.es (参数配置详见主页) 替换 gitment、gitalk</span></span><br><span class="line"><span class="attr">utterance:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">repo:</span> <span class="string">'yaojusheng.github.io'</span>     <span class="comment">#仓库名字,格式：你的用户ID/仓库名称，如：blog/utterance_repo</span></span><br><span class="line">  <span class="attr">issue_term:</span> <span class="string">'title'</span>            <span class="comment">#映射配置</span></span><br><span class="line">  <span class="attr">theme:</span> <span class="string">'github-light'</span>          <span class="comment">#主题</span></span><br></pre></td></tr></table></figure>

<h3 id="3-4-在文件-article-ejs-中添加配置"><a href="#3-4-在文件-article-ejs-中添加配置" class="headerlink" title="3.4.在文件 article.ejs 中添加配置"></a>3.4.在文件 <code>article.ejs</code> 中添加配置</h3><p>打开 <code>themes\yilia-plus\layout\_partial\article.ejs</code> 文件，添加：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">%</span> <span class="attr">if</span> (<span class="attr">theme.utterance</span> &amp;&amp; <span class="attr">theme.utterance.enable</span>)&#123; %&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">section</span> <span class="attr">id</span>=<span class="string">"comments"</span> <span class="attr">class</span>=<span class="string">"comments"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="css">        <span class="selector-class">.utterances</span>&#123;<span class="attribute">max-width</span>: <span class="number">100%</span>;&#125;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://utteranc.es/client.js"</span></span></span><br><span class="line"><span class="tag">          <span class="attr">repo</span>=<span class="string">"&lt;%= theme.utterance.repo %&gt;"</span></span></span><br><span class="line"><span class="tag">          <span class="attr">issue-term</span>=<span class="string">"&lt;%= theme.utterance.issue_term %&gt;"</span></span></span><br><span class="line"><span class="tag">          <span class="attr">theme</span>=<span class="string">"&lt;%= theme.utterance.theme %&gt;"</span></span></span><br><span class="line"><span class="tag">          <span class="attr">crossorigin</span>=<span class="string">"anonymous"</span></span></span><br><span class="line"><span class="tag">          <span class="attr">async</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">section</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">%</span> &#125; %&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="4-Giteement配置"><a href="#4-Giteement配置" class="headerlink" title="4.Giteement配置"></a>4.Giteement配置</h2><blockquote>
<p>基于码云的评论系统，类似GitHub的配置</p>
</blockquote>
<h3 id="4-1-新建-giteement-ejs-文件"><a href="#4-1-新建-giteement-ejs-文件" class="headerlink" title="4.1.新建 giteement.ejs 文件"></a>4.1.新建 <code>giteement.ejs</code> 文件</h3><p>在 <code>themes\yilia-plus\layout\_partial\post</code> 目录下，新建 <code>giteement.ejs</code> 文件，添加如下内容：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">%</span> <span class="attr">if</span> (!<span class="attr">index</span> &amp;&amp; <span class="attr">post.comments</span> &amp;&amp; <span class="attr">theme.giteement</span> &amp;&amp; <span class="attr">theme.giteement.enable</span>)&#123; %&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"giteement-ctn"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">%</span> <span class="attr">if</span> (<span class="attr">theme.giteement</span> &amp;&amp; <span class="attr">theme.giteement.remote</span>)&#123; %&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- &lt;link rel="stylesheet" href="https://giteement.oss-cn-beijing.aliyuncs.com/wd-discuss.css"&gt; --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- &lt;script src="https://giteement.oss-cn-beijing.aliyuncs.com/discuss_hexo.js"&gt;&lt;/script&gt; --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">href</span>=<span class="string">"https://giteement.oss-cn-beijing.aliyuncs.com/default.css"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://giteement.oss-cn-beijing.aliyuncs.com/giteement.browser.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">%</span> &#125; <span class="attr">else</span> &#123; %&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">href</span>=<span class="string">"&lt;%- url_for('lib/default.css') %&gt;"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"&lt;%- url_for('lib/giteement.browser.js') %&gt;"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">%</span> &#125; %&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="handlebars"><span class="xml">  <span class="comment">&lt;!-- id: "&lt;%= page.title %&gt;" --&gt;</span></span></span></span><br><span class="line"><span class="actionscript">  <span class="keyword">var</span> giteement = <span class="keyword">new</span> Giteement(&#123;</span></span><br><span class="line"><span class="actionscript">    id: <span class="string">'&lt;%=page.date.format('</span>YYYYMMDDHHmmss<span class="string">')%&gt;'</span>,</span></span><br><span class="line"><span class="actionscript">    owner: <span class="string">'&lt;%=theme.giteement.giteeID%&gt;'</span>,</span></span><br><span class="line"><span class="actionscript">    repo: <span class="string">'&lt;%=theme.giteement.repo%&gt;'</span>,</span></span><br><span class="line"><span class="actionscript">    backcall_uri: <span class="string">'&lt;%=theme.giteement.redirect_uri%&gt;'</span>,</span></span><br><span class="line"><span class="actionscript">    oauth_uri: <span class="string">'&lt;%=theme.giteement.oauth_uri%&gt;'</span>,</span></span><br><span class="line">    oauth: &#123;</span><br><span class="line"><span class="actionscript">      client_id: <span class="string">'&lt;%=theme.giteement.gitment_oauth.client_id%&gt;'</span>,</span></span><br><span class="line"><span class="actionscript">      client_secret: <span class="string">'&lt;%=theme.giteement.gitment_oauth.client_secret%&gt;'</span></span></span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;)</span><br><span class="line"><span class="actionscript">  giteement.render(<span class="string">'giteement-ctn'</span>)</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">%</span> &#125; %&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="4-2-修改主题配置文件-config-yml"><a href="#4-2-修改主题配置文件-config-yml" class="headerlink" title="4.2.修改主题配置文件 _config.yml"></a>4.2.修改主题配置文件 <code>_config.yml</code></h3><p>打开文件 <code>themes\yilia-plus\_config.yml</code> , 修改配置：</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">giteement:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span>  <span class="comment"># 是否启用码云评论系统</span></span><br><span class="line">  <span class="comment"># 是否使用官方js(false可以提升访问速度)</span></span><br><span class="line">  <span class="attr">remote:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">redirect_uri:</span> <span class="string">''</span>   <span class="comment"># 应用回调地址(请和配置的第三方应用保持一致)</span></span><br><span class="line">  <span class="comment"># 不能更改(网上开源项目https://github.com/Rob--W/cors-anywhere作者提供的专门用来跨域服务器的配置)</span></span><br><span class="line">  <span class="attr">oauth_uri:</span> <span class="string">https://cors-anywhere.herokuapp.com/https://gitee.com/oauth/token</span></span><br><span class="line">  <span class="attr">giteeID:</span> <span class="string">''</span>  <span class="comment"># 你的码云账号英文名</span></span><br><span class="line">  <span class="comment"># 存储评论的 repo</span></span><br><span class="line">  <span class="attr">repo:</span> <span class="string">yilia-plus-demo</span></span><br><span class="line">  <span class="attr">gitment_oauth:</span></span><br><span class="line">    <span class="attr">client_id:</span> <span class="string">'*********'</span>           <span class="comment">#client ID</span></span><br><span class="line">    <span class="attr">client_secret:</span> <span class="string">'*********'</span>       <span class="comment">#client secret</span></span><br></pre></td></tr></table></figure>

<h3 id="4-3-在文件-article-ejs-中添加配置"><a href="#4-3-在文件-article-ejs-中添加配置" class="headerlink" title="4.3.在文件 article.ejs 中添加配置"></a>4.3.在文件 <code>article.ejs</code> 中添加配置</h3><p>打开 <code>themes\yilia-plus\layout\_partial\article.ejs</code> 文件，添加：</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&lt;% <span class="keyword">if</span> (theme.giteement &amp;&amp; theme.giteement.enable)&#123; %&gt;</span><br><span class="line">&lt;%- partial(<span class="string">'post/giteement'</span>, &#123;</span><br><span class="line">      key: post.slug,</span><br><span class="line">      title: post.title,</span><br><span class="line">      url: config.url+url_for(post.path)</span><br><span class="line">    &#125;) %&gt;</span><br><span class="line">&lt;% &#125; %&gt;</span><br></pre></td></tr></table></figure>

<h2 id="5-Valine配置"><a href="#5-Valine配置" class="headerlink" title="5.Valine配置"></a>5.Valine配置</h2><h3 id="5-1-注册-LeanCloud"><a href="#5-1-注册-LeanCloud" class="headerlink" title="5.1.注册 LeanCloud"></a>5.1.注册 <code>LeanCloud</code></h3><p>先到 <a href="https://leancloud.cn/dashboard/login.html#/signup" target="_blank" rel="noopener">leancloud</a>进行注册、创建应用等等，页面有帮助教程。</p>
<p>到【设置】-【应用keys】，找到 <code>AppID</code> 和 <code>AppKey</code> ，配置需要。</p>
<h3 id="5-2-部署云引擎"><a href="#5-2-部署云引擎" class="headerlink" title="5.2.部署云引擎"></a>5.2.部署云引擎</h3><ol>
<li>在Leancloud 【云引擎】-【设置】界面，创建代码仓库，并保存：<code>https://github.com/DesertsP/Valine-Admin.git</code></li>
<li>设置环境变量</li>
<li>部署（分支选master）</li>
</ol>
<p>可参考：<a href="https://deserts.io/valine-admin-document/" target="_blank" rel="noopener">Valine配置手册</a></p>
<h3 id="5-3-新建-valine-ejs-文件"><a href="#5-3-新建-valine-ejs-文件" class="headerlink" title="5.3.新建 valine.ejs 文件"></a>5.3.新建 <code>valine.ejs</code> 文件</h3><p>在 <code>themes\yilia-plus\layout\_partial\post</code> 目录下，新建 <code>valine.ejs</code> 文件，添加如下内容：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"valine_comment"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--载入js，在&lt;/body&gt;之前插入即可--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--Leancloud 操作库:--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"//cdn1.lncld.net/static/js/3.0.4/av-min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--Valine 的核心代码库--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"//unpkg.com/valine/dist/Valine.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="actionscript">  <span class="keyword">var</span> notify = <span class="string">'&lt;%= theme.valine.notify %&gt;'</span> == <span class="literal">true</span> ? <span class="literal">true</span> : <span class="literal">false</span>;</span></span><br><span class="line"><span class="actionscript">  <span class="keyword">var</span> verify = <span class="string">'&lt;%= theme.valine.verify %&gt;'</span> == <span class="literal">true</span> ? <span class="literal">true</span> : <span class="literal">false</span>;</span></span><br><span class="line"><span class="actionscript">  <span class="keyword">new</span> Valine(&#123;</span></span><br><span class="line">      av: AV,</span><br><span class="line"><span class="actionscript">      el: <span class="string">'.valine_comment'</span>,</span></span><br><span class="line"><span class="actionscript">      emoticon_url: <span class="string">'https://cloud.panjunwen.com/alu'</span>,</span></span><br><span class="line"><span class="actionscript">      emoticon_list: [<span class="string">"狂汗.png"</span>,<span class="string">"不说话.png"</span>,<span class="string">"汗.png"</span>,<span class="string">"坐等.png"</span>,<span class="string">"献花.png"</span>,<span class="string">"不高兴.png"</span>,<span class="string">"中刀.png"</span>,<span class="string">"害羞.png"</span>,<span class="string">"皱眉.png"</span>,<span class="string">"小眼睛.png"</span>,<span class="string">"暗地观察.png"</span>],</span></span><br><span class="line"><span class="actionscript">      app_id: <span class="string">'&lt;%= theme.valine.appid %&gt;'</span>,</span></span><br><span class="line"><span class="actionscript">      app_key: <span class="string">'&lt;%= theme.valine.appkey %&gt;'</span>,</span></span><br><span class="line"><span class="actionscript">      placeholder: <span class="string">'&lt;%= theme.valine.placeholder %&gt;'</span></span></span><br><span class="line">    &#125;);</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="5-4-修改主题配置文件-config-yml"><a href="#5-4-修改主题配置文件-config-yml" class="headerlink" title="5.4.修改主题配置文件 _config.yml"></a>5.4.修改主题配置文件 <code>_config.yml</code></h3><p>打开文件 <code>themes\yilia-plus\_config.yml</code> , 修改配置：</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># valine 评论系统，到leancloud进行注册</span></span><br><span class="line"><span class="comment"># https://leancloud.cn/dashboard/login.html#/signup</span></span><br><span class="line"><span class="attr">valine:</span></span><br><span class="line"> <span class="attr">appid:</span> <span class="string">''</span>  <span class="comment"># Leancloud应用的appId</span></span><br><span class="line"> <span class="attr">appkey:</span> <span class="string">''</span>          <span class="comment"># Leancloud应用的appKey</span></span><br><span class="line"> <span class="attr">verify:</span> <span class="literal">false</span>      <span class="comment"># 验证码</span></span><br><span class="line"> <span class="attr">notify:</span> <span class="literal">true</span>       <span class="comment"># 评论回复提醒</span></span><br><span class="line"> <span class="attr">avatar:</span> <span class="string">mm</span>        <span class="comment"># 评论列表头像样式（https://valine.js.org/avatar）</span></span><br><span class="line"> <span class="attr">placeholder:</span> <span class="string">欢迎您的评论~</span> <span class="comment"># 评论框占位符</span></span><br></pre></td></tr></table></figure>

<h3 id="5-5-在文件-article-ejs-中添加配置"><a href="#5-5-在文件-article-ejs-中添加配置" class="headerlink" title="5.5.在文件 article.ejs 中添加配置"></a>5.5.在文件 <code>article.ejs</code> 中添加配置</h3><p>打开 <code>themes\yilia-plus\layout\_partial\article.ejs</code> 文件，添加：</p>
<figure class="highlight xl"><table><tr><td class="code"><pre><span class="line">&lt;% <span class="keyword">if</span> (<span class="built_in">theme</span>.valine &amp;&amp; <span class="built_in">theme</span>.valine.appid &amp;&amp; <span class="built_in">theme</span>.valine.appkey)&#123; %&gt;</span><br><span class="line">    &lt;section id=<span class="string">"comments"</span> style=<span class="string">"margin:10px;padding:10px;background:#fff;"</span>&gt;</span><br><span class="line">      &lt;%- partial(<span class="string">'post/valine'</span>, &#123;</span><br><span class="line">        key: post.slug,</span><br><span class="line">        <span class="built_in">title</span>: post.<span class="built_in">title</span>,</span><br><span class="line">        url: config.url+url_for(post.<span class="built_in">path</span>)</span><br><span class="line">        &#125;) %&gt;</span><br><span class="line">    &lt;/section&gt;</span><br><span class="line">  &lt;% &#125; %&gt;</span><br></pre></td></tr></table></figure>


<hr>
]]></content>
      <categories>
        <category>网站</category>
        <category>Hexo</category>
      </categories>
      <tags>
        <tag>yilia</tag>
        <tag>评论系统</tag>
      </tags>
  </entry>
  <entry>
    <title>Hexo搭建个人博客：yilia主题配置(二) - 背景图片</title>
    <url>/blog/archives/4235.html</url>
    <content><![CDATA[<p>本文主要讲述 <code>Hexo-yilia</code> 主题中，关于背景和图片的相关配置。与前面一样，使用主题： <a href="https://github.com/JoeyBling/hexo-theme-yilia-plus" target="_blank" rel="noopener">hexo-theme-yilia-plus</a></p>
<a id="more"></a>

<h2 id="1-头像与网站图标"><a href="#1-头像与网站图标" class="headerlink" title="1.头像与网站图标"></a>1.头像与网站图标</h2><h3 id="1-1-添加头像和网站图标"><a href="#1-1-添加头像和网站图标" class="headerlink" title="1.1.添加头像和网站图标"></a>1.1.添加头像和网站图标</h3><p>打开主题配置文件 <code>_config.yml</code>, 添加：</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 网站图标</span></span><br><span class="line"><span class="attr">favicon:</span> <span class="string">/img/favicon.ico</span></span><br><span class="line"><span class="comment"># 你的头像url</span></span><br><span class="line"><span class="attr">avatar:</span> <span class="string">/images/avatar.jpg</span></span><br></pre></td></tr></table></figure>
<p><strong>头像地址可以分两种</strong>：</p>
<ul>
<li>本地<ul>
<li>根目录中的 <code>source</code> 目录：可以在 <code>source</code> 目录下建立 <code>images</code> 文件夹，存放图片</li>
<li>主题目录的 <code>source</code> 目录：建立 <code>img</code> 文件夹，存放图片</li>
</ul>
</li>
<li>网络<ul>
<li>配置后写链接地址</li>
</ul>
</li>
</ul>
<h3 id="1-2-头像旋转"><a href="#1-2-头像旋转" class="headerlink" title="1.2.头像旋转"></a>1.2.头像旋转</h3><p>修改 <code>yilia-plus\source\main.b8fa34.css</code> 文件 (原ylia主题是 <code>main.0cf68a.css</code> 文件)<br>文本编辑器 <code>Ctrl+F</code> , 搜索 <code>.left-col #header .profilepic img</code> ,修改为：</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.left-col</span> <span class="selector-id">#header</span> <span class="selector-class">.profilepic</span> <span class="selector-tag">img</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">background</span>: <span class="number">#88acdb</span>;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">50%</span>;</span><br><span class="line">    <span class="attribute">border</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">-webkit-transition</span>: -webkit-transform <span class="number">1s</span> ease-out;</span><br><span class="line">    <span class="attribute">-moz-transition</span>: -moz-transform <span class="number">1s</span> ease-out;</span><br><span class="line">    <span class="attribute">-o-transition</span>: -o-transform <span class="number">1s</span> ease-out;</span><br><span class="line">    <span class="attribute">-ms-transition</span>: -ms-transform <span class="number">1s</span> ease-out</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.left-col</span> <span class="selector-id">#header</span> <span class="selector-class">.profilepic</span> <span class="selector-tag">img</span><span class="selector-class">.show</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">opacity</span>: <span class="number">1</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.left-col</span> <span class="selector-id">#header</span> <span class="selector-class">.profilepic</span> <span class="selector-tag">img</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">1turn</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="2-左侧边栏配置"><a href="#2-左侧边栏配置" class="headerlink" title="2.左侧边栏配置"></a>2.左侧边栏配置</h2><blockquote>
<p>同上，可以在css文件中设置，这里 <code>yilia-plus</code> 做了灵活的配置。</p>
</blockquote>
<h3 id="2-1-头像上方动图"><a href="#2-1-头像上方动图" class="headerlink" title="2.1.头像上方动图"></a>2.1.头像上方动图</h3><ul>
<li>打开主题配置文件 <code>themes\yilia-plus\_config.yml</code>，找到 <code>style</code> 配置项，作如下修改：</li>
</ul>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">style:</span></span><br><span class="line"><span class="comment"># 左侧头像板块动态图效果</span></span><br><span class="line">  <span class="attr">gif:</span></span><br><span class="line">    <span class="comment"># 是否启用</span></span><br><span class="line">    <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">    <span class="comment"># 自定义背景图路径(默认可以不设置，提供默认背景图biubiubiu.gif)</span></span><br><span class="line">    <span class="attr">path:</span> <span class="string">这里是gif图片地址</span></span><br></pre></td></tr></table></figure>

<ul>
<li>打开left-col.ejs文件，修改配置：</li>
</ul>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">%</span> <span class="attr">var</span> <span class="attr">defaultBg</span> = <span class="string">'#4d4d4d'</span>; %&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">%</span> <span class="attr">var</span> <span class="attr">defaultBgImg</span> = <span class="string">'/img/biubiubiu.gif'</span>; %&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">%</span> <span class="attr">var</span> <span class="attr">overlayBgImg</span>= <span class="string">theme.style.gif</span> &amp;&amp; <span class="attr">theme.style.gif.enable</span> &amp;&amp; <span class="attr">theme.style.gif.path</span> ? <span class="attr">theme.style.gif.path</span> <span class="attr">:</span> <span class="attr">defaultBgImg</span>; %&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"overlay"</span> <span class="attr">style</span>=<span class="string">"background: &lt;%= theme.style &amp;&amp; theme.style.header ? theme.style.header : defaultBg %&gt;;&lt;% if (theme.style.gif &amp;&amp; theme.style.gif.enable)&#123; %&gt;background: url('&lt;%- url_for(overlayBgImg) %&gt;') no-repeat ;&lt;%&#125;%&gt; z-index:-1"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="2-2-左侧边栏背景"><a href="#2-2-左侧边栏背景" class="headerlink" title="2.2.左侧边栏背景"></a>2.2.左侧边栏背景</h3><ul>
<li>打开主题配置文件 <code>themes\yilia-plus\_config.yml</code>，找到 <code>style</code> 配置项，作如下修改：</li>
</ul>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">style:</span></span><br><span class="line">  <span class="comment"># 头像上面的背景颜色 e.g. linear-gradient(rgba(255, 255, 255, 0.5), rgba(255, 255, 255, 0.5))</span></span><br><span class="line">  <span class="comment"># header: '#D3D1DC'</span></span><br><span class="line">  <span class="attr">header:</span> <span class="string">'rgba(0,0,0,0.5)'</span> <span class="comment">#设置背景透明度，不然头像上方是默认色</span></span><br><span class="line">  <span class="comment">#左侧头像板块的背景颜色(IE兼容设置：filter:alpha(opacity=80);)</span></span><br><span class="line">  <span class="attr">left_ground:</span> </span><br><span class="line">    <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">default:</span> <span class="string">'rgba(0,0,0,0.5)'</span></span><br><span class="line">    <span class="attr">url:</span> <span class="string">'url(这里是图片链接) no-repeat 100%;background-size:cover;opacity:0.8;filter:alpha(opacity=80);'</span></span><br></pre></td></tr></table></figure>
<ul>
<li>打开布局文件 <code>themes\yilia-plus\layout\layout.ejs</code>，找到 <code>&lt;div class=&quot;left-col&quot; ... &lt;/div&gt;</code> ，改成:</li>
</ul>
<figure class="highlight cs"><table><tr><td class="code"><pre><span class="line">&lt;div <span class="keyword">class</span>=<span class="string">"left-col"</span> q-<span class="keyword">class</span>=<span class="string">"show:isShow"</span>  style=<span class="string">"background: &lt;%= theme.style &amp;&amp; theme.style.left_ground.enable &amp;&amp; theme.style.left_ground.url ? theme.style.left_ground.url : theme.style.left_ground.default %&gt;"</span>&gt;</span><br><span class="line">      &lt;%- <span class="keyword">partial</span>(<span class="string">'_partial/left-col'</span>, <span class="literal">null</span>, &#123;cache: !config.relative_link&#125;) %&gt;</span><br><span class="line">    &lt;/div&gt;</span><br></pre></td></tr></table></figure>

<ul>
<li>打开样式文件 <code>yilia-plus\source\main.b8fa34.css</code>，搜索 <code>.left-col</code> ，修改背景颜色如下：</li>
</ul>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.left-col</span> &#123;</span><br><span class="line">    <span class="comment">/*background: #fff;*/</span></span><br><span class="line">    <span class="attribute">background-color</span>: <span class="built_in">linear-gradient</span>(rgba(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.5</span>), <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.5</span>));</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">300px</span>;</span><br><span class="line">    <span class="attribute">position</span>: fixed;</span><br><span class="line">    <span class="attribute">opacity</span>: <span class="number">1</span>;</span><br><span class="line">    <span class="attribute">transition</span>: all .<span class="number">2s</span> ease-in;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">z-index</span>: <span class="number">999</span>;</span><br><span class="line">    <span class="attribute">overflow</span>: hidden;</span><br><span class="line">    <span class="attribute">overflow-y</span>: auto;</span><br><span class="line">    <span class="attribute">margin-bottom</span>: <span class="number">15px</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="2-3-右滑板块背景"><a href="#2-3-右滑板块背景" class="headerlink" title="2.3.右滑板块背景"></a>2.3.右滑板块背景</h3><p>打开主题配置文件 <code>themes\yilia-plus\_config.yml</code>，找到 <code>style</code> 配置项修改 <code>slider</code>：</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">style:</span></span><br><span class="line">  <span class="comment"># 右滑板块背景</span></span><br><span class="line">  <span class="attr">slider:</span> <span class="string">'linear-gradient(200deg,#ccc,#000)'</span></span><br></pre></td></tr></table></figure>
<p>可以根据自己喜好调整</p>
<h3 id="2-4-背景音乐插件"><a href="#2-4-背景音乐插件" class="headerlink" title="2.4.背景音乐插件"></a>2.4.背景音乐插件</h3><blockquote>
<p>插入音乐视频前，先安装插件：</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm install hexo-tag-dplayer --save</span><br><span class="line">npm install hexo-tag-aplayer --save</span><br></pre></td></tr></table></figure>

<ul>
<li><p>这里用<a href="https://music.163.com/" target="_blank" rel="noopener">网易云</a>插件，打开一首歌，下方有 <code>生成外链</code> 提示，如：</p>
<div align="center">
  <img src="/blog/images/wangyiyun/changyemanman-20-02-20.png" width="400px">
</div>
</li>
<li><p>点击该链接，然后复制生成的HTML代码，配置时用。：</p>
</li>
</ul>
<div align="center">
    <img src="/blog/images/wangyiyun/changyemanman-link-20-02-20.png" width="450px">
</div>

<ul>
<li>在主题配置文件 <code>_config.yml</code> 找到</li>
</ul>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 网易云音乐插件</span></span><br><span class="line"><span class="attr">music:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="comment"># 播放器尺寸类型(1：短尺寸、2：长尺寸)</span></span><br><span class="line">  <span class="attr">type:</span> <span class="number">2</span></span><br><span class="line">  <span class="attr">id:</span> <span class="number">411907505</span>  <span class="comment"># 网易云分享的音乐ID(更换音乐请更改此配置项)</span></span><br><span class="line">  <span class="attr">autoPlay:</span> <span class="literal">true</span>  <span class="comment"># 是否开启自动播放</span></span><br><span class="line">  <span class="comment"># 提示文本(关闭请设置为false)</span></span><br><span class="line">  <span class="attr">text:</span> <span class="string">'写一段说明文字'</span></span><br></pre></td></tr></table></figure>

<ul>
<li>在left-col.ejs文件中，添加配置：</li>
</ul>
<figure class="highlight erb"><table><tr><td class="code"><pre><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">%</span></span></span><span class="ruby"> <span class="keyword">if</span> (theme.music &amp;&amp; theme.music.enable)&#123; </span><span class="xml"><span class="tag">%&gt;</span></span></span><br><span class="line"><span class="xml">            </span><span class="comment">&lt;%# "网易云音乐插件" %&gt;</span></span><br><span class="line"><span class="xml">            </span><span class="comment">&lt;%# "bottom:120px; left:auto;position:absolute;  width:85%" %&gt;</span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">%</span></span></span><span class="ruby"> var defaultHeight = theme.music.type == <span class="number">1</span> ? <span class="string">'32'</span> : <span class="string">'66'</span>; </span><span class="xml"><span class="tag">%&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">%</span></span></span><span class="ruby"> var defaultIframeHeight = theme.music.type == <span class="number">1</span> ? <span class="string">'52'</span> : <span class="string">'86'</span>; </span><span class="xml"><span class="tag">%&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">"margin-right:10px;margin-left:0; padding:5px 0"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;<span class="name">iframe</span> <span class="attr">frameborder</span>=<span class="string">"no"</span> <span class="attr">border</span>=<span class="string">"0"</span> <span class="attr">marginwidth</span>=<span class="string">"0"</span> <span class="attr">marginheight</span>=<span class="string">"0"</span> <span class="attr">width</span>=<span class="string">"250"</span> <span class="attr">height</span>=<span class="string">"&lt;%=</span></span></span><span class="ruby">defaultIframeHeight</span><span class="xml"><span class="tag"><span class="string">%&gt;"</span> <span class="attr">src</span>=<span class="string">"//music.163.com/outchain/player?type=2&amp;id=&lt;%=</span></span></span><span class="ruby">theme.music.id<span class="params">||</span><span class="number">411907505</span></span><span class="xml"><span class="tag"><span class="string">%&gt;&amp;auto=&lt;%=</span></span></span><span class="ruby">theme.music.autoPlay?<span class="number">1</span><span class="symbol">:</span><span class="number">0</span></span><span class="xml"><span class="tag"><span class="string">%&gt;&amp;height=&lt;%=</span></span></span><span class="ruby">defaultHeight</span><span class="xml"><span class="tag"><span class="string">%&gt;"</span>&gt;</span><span class="tag">&lt;/<span class="name">iframe</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">%</span></span></span><span class="ruby"> <span class="keyword">if</span> (theme.music.text <span class="params">||</span> theme.music.text == null)&#123; </span><span class="xml"><span class="tag">%&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;<span class="name">%</span></span></span><span class="ruby"> var musicText = ( theme.music.text == null <span class="params">||</span> theme.music.text == <span class="literal">true</span> ) ? <span class="string">"默认说明文字"</span> : theme.music.text; </span><span class="xml"><span class="tag">%&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;<span class="name">p</span> <span class="attr">style</span>=<span class="string">"font-size: 12px;"</span>&gt;</span><span class="tag">&lt;<span class="name">%-</span></span></span><span class="ruby">musicText</span><span class="xml"><span class="tag">%&gt;</span><span class="tag">&lt;<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">%</span></span></span><span class="ruby"> &#125; </span><span class="xml"><span class="tag">%&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">%</span></span></span><span class="ruby"> &#125; </span><span class="xml"><span class="tag">%&gt;</span></span></span><br></pre></td></tr></table></figure>


<h2 id="3-右边正文背景"><a href="#3-右边正文背景" class="headerlink" title="3.右边正文背景"></a>3.右边正文背景</h2><ul>
<li>和左侧边栏修改类似，打开文件 <code>themes\yilia-plus\_config.yml</code>，找到 <code>style</code> 配置项，作如下修改：</li>
</ul>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">style:</span></span><br><span class="line">  <span class="comment"># 正文的背景颜色(IE兼容设置：opacity:0.8;filter:alpha(opacity=80);)</span></span><br><span class="line">  <span class="attr">article_ground:</span> </span><br><span class="line">    <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">default:</span> <span class="string">'rgba(25, 25, 25, 0)'</span>  <span class="comment">#设置背景透明度</span></span><br><span class="line">    <span class="attr">url:</span> <span class="string">'url(图片链接地址) no-repeat 100%;background-size:cover;opacity:0.7;filter:alpha(opacity=70);'</span></span><br></pre></td></tr></table></figure>

<ul>
<li>打开布局文件 <code>themes\yilia-plus\layout\layout.ejs</code>，找到 <code>&lt;div class=&quot;mid-col&quot; ... &gt;</code> ，修改:</li>
</ul>
<figure class="highlight cs"><table><tr><td class="code"><pre><span class="line">&lt;div <span class="keyword">class</span>=<span class="string">"mid-col"</span> q-<span class="keyword">class</span>=<span class="string">"show:isShow,hide:isShow|isFalse"</span> style=<span class="string">"background: &lt;%= theme.style &amp;&amp; theme.style.article_ground.enable &amp;&amp; theme.style.article_ground.url ? theme.style.article_ground.url : theme.style.article_ground.default %&gt;"</span>&gt;</span><br></pre></td></tr></table></figure>

<ul>
<li>如果想修改正文显示部分的样式，可以打开样式文件 <code>yilia-plus\source\main.b8fa34.css</code>，搜索 <code>.article</code>、<code>.article-inner</code> 、<code>.archives-wrap</code> 、 <code>.archives .archive-article-title</code> 等，修改字体、背景颜色：</li>
</ul>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.article</span> &#123;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">30px</span>;</span><br><span class="line">    <span class="attribute">position</span>: relative;</span><br><span class="line">    <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#ddd</span>;</span><br><span class="line">    <span class="attribute">border-top</span>: <span class="number">1px</span> solid <span class="number">#fff</span>;</span><br><span class="line">    <span class="attribute">border-bottom</span>: <span class="number">1px</span> solid <span class="number">#fff</span>;</span><br><span class="line">    <span class="comment">/*background: #fff;*/</span></span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">255</span>,<span class="number">255</span>,<span class="number">255</span>,.<span class="number">5</span>);</span><br><span class="line">    <span class="attribute">transition</span>: all .<span class="number">2s</span> ease-in;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*主页*/</span></span><br><span class="line"><span class="selector-class">.article-inner</span> &#123;</span><br><span class="line">    <span class="comment">/*border-color: #d1d1d1；*/</span></span><br><span class="line">    <span class="attribute">background-color</span>: <span class="built_in">rgba</span>(<span class="number">193</span>, <span class="number">194</span>, <span class="number">195</span>,<span class="number">0.6</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.left-col</span> &#123;</span><br><span class="line">    <span class="attribute">background-color</span>: <span class="built_in">linear-gradient</span>(rgba(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.5</span>), <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>,<span class="number">255</span>, <span class="number">0.5</span>));</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">300px</span>;</span><br><span class="line">    <span class="attribute">position</span>: fixed;</span><br><span class="line">    <span class="attribute">opacity</span>: <span class="number">1</span>;</span><br><span class="line">    <span class="attribute">transition</span>: all .<span class="number">2s</span> ease-in;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">z-index</span>: <span class="number">999</span>;</span><br><span class="line">    <span class="attribute">overflow</span>: hidden;</span><br><span class="line">    <span class="attribute">overflow-y</span>: auto;</span><br><span class="line">    <span class="attribute">margin-bottom</span>: <span class="number">15px</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*归档*/</span></span><br><span class="line"><span class="selector-class">.archives-wrap</span> &#123;</span><br><span class="line">    <span class="attribute">position</span>: relative;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">0</span> <span class="number">30px</span>;</span><br><span class="line">    <span class="attribute">padding-right</span>: <span class="number">60px</span>;</span><br><span class="line">    <span class="attribute">border-bottom</span>: <span class="number">1px</span> solid <span class="number">#eee</span>;</span><br><span class="line">    <span class="comment">/*background: #fff;*/</span></span><br><span class="line">    <span class="attribute">background-color</span>: <span class="built_in">rgba</span>(<span class="number">236</span>, <span class="number">236</span>, <span class="number">236</span>,<span class="number">0.6</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*字体*/</span></span><br><span class="line"><span class="selector-class">.archives</span> <span class="selector-class">.archive-article-title</span> &#123;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">16px</span>;</span><br><span class="line">    <span class="attribute">font-weight</span>: bold;</span><br><span class="line">    <span class="comment">/*color: #333;*/</span></span><br><span class="line">    <span class="comment">/*transition: color .3s*/</span></span><br><span class="line">    <span class="attribute">background</span>: transparent;</span><br><span class="line">    <span class="attribute">text-decoration</span>: none;</span><br><span class="line">    <span class="attribute">color</span>: # af9;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="4-动态线条背景"><a href="#4-动态线条背景" class="headerlink" title="4.动态线条背景"></a>4.动态线条背景</h2><blockquote>
<p>安装插件: npm install –save canvas-nest.js，或直接显式配置</p>
</blockquote>
<ul>
<li>主题配置，在文件 <code>themes\yilia-plus\_config.yml</code> 中，添加：</li>
</ul>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 动态线条效果，会向鼠标集中</span></span><br><span class="line"><span class="attr">canvas_nest:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">color:</span> <span class="string">'206, 187, 95'</span></span><br><span class="line">  <span class="attr">pointColor:</span> <span class="string">'249, 72, 97'</span>     </span><br><span class="line">  <span class="attr">opacity:</span> <span class="string">'0.9'</span>             </span><br><span class="line">  <span class="attr">count:</span> <span class="string">'136'</span>     </span><br><span class="line">  <span class="attr">zIndex:</span> <span class="string">'-1'</span></span><br></pre></td></tr></table></figure>

<ul>
<li>找到文件 <code>themes\yilia-plus\layout\layout.ejs</code>，添加：</li>
</ul>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">&lt;% <span class="keyword">if</span> (theme.canvas_nest)&#123; %&gt;</span><br><span class="line">&lt;script <span class="attribute">type</span>=<span class="string">"text/javascript"</span></span><br><span class="line"><span class="attribute">color</span>=<span class="string">"0,0,255"</span> <span class="attribute">opacity</span>=<span class="string">'0.9'</span> <span class="attribute">zIndex</span>=<span class="string">"-1"</span> <span class="attribute">count</span>=<span class="string">"300"</span> <span class="attribute">src</span>=<span class="string">"&lt;%- url_for('//cdn.bootcss.com/canvas-nest.js/1.0.0/canvas-nest.min.js') %&gt;"</span>&gt;&lt;/script&gt;</span><br><span class="line">&lt;% &#125; %&gt;</span><br></pre></td></tr></table></figure>


<h2 id="5-雪花特效"><a href="#5-雪花特效" class="headerlink" title="5.雪花特效"></a>5.雪花特效</h2><ul>
<li>在主题目录 <code>source/lib</code> 下新建 <code>snow.js</code> 文件，内容添加：</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> snow = &#123;</span><br><span class="line">  info: &#123;</span><br><span class="line">    top: <span class="number">0</span>,</span><br><span class="line">    left: <span class="number">0</span>,</span><br><span class="line">    zIndex: <span class="number">500</span>,</span><br><span class="line">    number: <span class="number">70</span></span><br><span class="line">  &#125;,</span><br><span class="line">  down: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> f = <span class="built_in">window</span>.innerWidth;</span><br><span class="line">    <span class="keyword">var</span> g = <span class="built_in">window</span>.innerHeight;</span><br><span class="line">    <span class="keyword">var</span> d = <span class="built_in">document</span>.createElement(<span class="string">"canvas"</span>);</span><br><span class="line">    d.style.position = <span class="string">"fixed"</span>;</span><br><span class="line">    d.style.pointerEvents = <span class="string">"none"</span>;</span><br><span class="line">    d.style.top = snow.info.top + <span class="string">"px"</span>;</span><br><span class="line">    d.style.left = snow.info.left + <span class="string">"px"</span>;</span><br><span class="line">    d.style.zIndex = snow.info.zIndex;</span><br><span class="line">    d.width = f;</span><br><span class="line">    d.height = g;</span><br><span class="line">    <span class="built_in">document</span>.body.appendChild(d);</span><br><span class="line">    <span class="keyword">var</span> c = [];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> a = <span class="number">0</span>; a &lt; snow.info.number; a++) &#123;</span><br><span class="line">      c.push(&#123;</span><br><span class="line">        x: <span class="built_in">Math</span>.random() * f,</span><br><span class="line">        y: <span class="built_in">Math</span>.random() * g,</span><br><span class="line">        r: <span class="built_in">Math</span>.random() * <span class="number">4</span> + <span class="number">1</span>,</span><br><span class="line">        n: <span class="built_in">Math</span>.random() * <span class="number">70</span></span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> b = d.getContext(<span class="string">"2d"</span>);</span><br><span class="line">    <span class="keyword">var</span> e = <span class="number">0</span>;</span><br><span class="line">    setInterval(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        b.clearRect(<span class="number">0</span>, <span class="number">0</span>, f, g);</span><br><span class="line">        b.fillStyle = <span class="string">"rgba(255, 255, 255, 0.6)"</span>;</span><br><span class="line">        b.shadowBlur = <span class="number">5</span>;</span><br><span class="line">        b.shadowColor = <span class="string">"rgba(255, 255, 255, 0.9)"</span>;</span><br><span class="line">        b.beginPath();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> j = <span class="number">0</span>; j &lt; <span class="number">70</span>; j++) &#123;</span><br><span class="line">          <span class="keyword">var</span> h = c[j];</span><br><span class="line">          b.moveTo(h.x, h.y);</span><br><span class="line">          b.arc(h.x, h.y, h.r, <span class="number">0</span>, <span class="built_in">Math</span>.PI * <span class="number">2</span>, <span class="number">0</span>)</span><br><span class="line">        &#125;</span><br><span class="line">        b.fill();</span><br><span class="line">        e += <span class="number">0.01</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> j = <span class="number">0</span>; j &lt; <span class="number">70</span>; j++) &#123;</span><br><span class="line">          <span class="keyword">var</span> h = c[j];</span><br><span class="line">          h.y += <span class="built_in">Math</span>.cos(e + h.n) + h.r / <span class="number">2</span>;</span><br><span class="line">          h.x += <span class="built_in">Math</span>.sin(e) * <span class="number">2</span>;</span><br><span class="line">          <span class="keyword">if</span> (h.x &gt; f + <span class="number">5</span> || h.x &lt; <span class="number">-5</span> || h.y &gt; g) &#123;</span><br><span class="line">            c[j] = j % <span class="number">3</span> &gt; <span class="number">0</span> ? &#123;</span><br><span class="line">              x: <span class="built_in">Math</span>.random() * f,</span><br><span class="line">              y: <span class="number">-10</span>,</span><br><span class="line">              r: h.r,</span><br><span class="line">              n: h.n</span><br><span class="line">            &#125; : <span class="built_in">Math</span>.sin(e) &gt; <span class="number">0</span> ? &#123;</span><br><span class="line">              x: <span class="number">-5</span>,</span><br><span class="line">              y: <span class="built_in">Math</span>.random() * g,</span><br><span class="line">              r: h.r,</span><br><span class="line">              n: h.n</span><br><span class="line">            &#125; : &#123;</span><br><span class="line">              x: f + <span class="number">5</span>,</span><br><span class="line">              y: <span class="built_in">Math</span>.random() * g,</span><br><span class="line">              r: h.r,</span><br><span class="line">              n: h.n</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="number">15</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// yilia-plus主题已经集成了，可以直接用</span></span><br></pre></td></tr></table></figure>

<ul>
<li>布局文件<code>layout.ejs</code>，添加：</li>
</ul>
<figure class="highlight erb"><table><tr><td class="code"><pre><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">%</span></span></span><span class="ruby"> <span class="keyword">if</span> (theme.snow)&#123; </span><span class="xml"><span class="tag">%&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"&lt;%-</span></span></span><span class="ruby"> url_for(<span class="string">'lib/snow.js'</span>) </span><span class="xml"><span class="tag"><span class="string">%&gt;"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"&lt;%-</span></span></span><span class="ruby"> url_for(<span class="string">'lib/jquery-2.1.4.min.js'</span>) </span><span class="xml"><span class="tag"><span class="string">%&gt;"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="xml">    snow.down();</span></span><br><span class="line"><span class="xml">    $(window).resize(function() &#123;</span></span><br><span class="line"><span class="xml">      $("canvas").css("z-index","500").remove();</span></span><br><span class="line"><span class="xml">      snow.down();</span></span><br><span class="line"><span class="xml">    &#125;);</span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">%</span></span></span><span class="ruby"> &#125; </span><span class="xml"><span class="tag">%&gt;</span></span></span><br></pre></td></tr></table></figure>

<ul>
<li>最后更新一下主题配置文件 <code>_config.yml</code>:</li>
</ul>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 飘雪特效</span></span><br><span class="line"><span class="comment"># https://github.com/MlgmXyysd/snow.js</span></span><br><span class="line"><span class="attr">snow:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure>


<blockquote>
<p>可以参考这篇博客： <a href="https://yansheng836.github.io/article/cf9c6a5e.html#%E5%8A%A8%E6%80%81%E7%BA%BF%E6%9D%A1%E8%83%8C%E6%99%AF" target="_blank" rel="noopener">hexo多种特效配置</a></p>
</blockquote>
<hr>
]]></content>
      <categories>
        <category>网站</category>
        <category>Hexo</category>
      </categories>
      <tags>
        <tag>yilia</tag>
        <tag>背景图片</tag>
      </tags>
  </entry>
  <entry>
    <title>Hexo搭建个人博客：yilia主题配置(一) - 基础配置</title>
    <url>/blog/archives/31784.html</url>
    <content><![CDATA[<p>前两天搭建了一下个人博客，使用Hexo工具+GitHub/Gitee部署博客网站，这里简单记录一下搭建过程：</p>
<a id="more"></a>

<h2 id="1-安装Hexo"><a href="#1-安装Hexo" class="headerlink" title="1.安装Hexo"></a>1.安装Hexo</h2><blockquote>
<p>首先，确保已有node环境。</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm install hexo-cli -g</span><br><span class="line">npm install hexo-deployer-git --save  <span class="comment"># 最后如果需要部署到git，就要安装这个包</span></span><br></pre></td></tr></table></figure>

<h2 id="2-安装yilia主题"><a href="#2-安装yilia主题" class="headerlink" title="2.安装yilia主题"></a>2.安装yilia主题</h2><blockquote>
<p>首先，确保已安装git工具。</p>
</blockquote>
<h3 id="2-1-安装"><a href="#2-1-安装" class="headerlink" title="2.1.安装"></a>2.1.安装</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/litten/hexo-theme-yilia.git themes/yilia   <span class="comment"># 将hexo-theme-yilia安装到themes目录下</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>这里推荐 <a href="https://github.com/JoeyBling/hexo-theme-yilia-plus" target="_blank" rel="noopener">hexo-theme-yilia-plus</a> 项目，该项目对yilia主题做了一些优化和补充，感谢作者 JoeyBling 的贡献。以下皆以该主题做部署配置。</p>
</blockquote>
<h3 id="2-2-使用yilia主题"><a href="#2-2-使用yilia主题" class="headerlink" title="2.2.使用yilia主题"></a>2.2.使用yilia主题</h3><p>此处以 <a href="https://github.com/JoeyBling/hexo-theme-yilia-plus" target="_blank" rel="noopener">hexo-theme-yilia-plus</a>为例，打开根目录下的_config.yml文件，找到 <code>theme</code> 处, 修改配置：</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Extensions</span></span><br><span class="line"><span class="comment">## Plugins: https://hexo.io/plugins/</span></span><br><span class="line"><span class="comment">## Themes: https://hexo.io/themes/</span></span><br><span class="line"><span class="comment"># theme: landscape  # 默认主题</span></span><br><span class="line"><span class="attr">theme:</span> <span class="string">yilia-plus</span>  <span class="comment"># yilia</span></span><br></pre></td></tr></table></figure>
<p>其他配置：</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Site 网站</span></span><br><span class="line"><span class="attr">title:</span> <span class="string">''</span>             <span class="comment"># 网站标题</span></span><br><span class="line"><span class="attr">subtitle:</span> <span class="string">''</span>          <span class="comment"># 网站副标题</span></span><br><span class="line"><span class="attr">description:</span> <span class="string">''</span>       <span class="comment"># 网站描述</span></span><br><span class="line"><span class="attr">keywords:</span> <span class="string">''</span></span><br><span class="line"><span class="attr">author:</span> <span class="string">''</span>            <span class="comment"># 博主的名字</span></span><br><span class="line"><span class="attr">language:</span> <span class="string">zh-CN</span>       <span class="comment"># 网站使用的语言</span></span><br><span class="line"><span class="attr">timezone:</span> <span class="string">''</span>          <span class="comment"># 网站时区。Hexo 默认使用您电脑的时区</span></span><br></pre></td></tr></table></figure>

<h2 id="3-配置“所有文章”"><a href="#3-配置“所有文章”" class="headerlink" title="3.配置“所有文章”"></a>3.配置“所有文章”</h2><blockquote>
<p>“所有文章”按钮，需要插件生效。</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm i hexo-generator-json-content --save</span><br></pre></td></tr></table></figure>
<p>同时在根目录文件<code>_config.yml</code>下, 配置：</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 新增内容</span></span><br><span class="line"><span class="attr">jsonContent:</span></span><br><span class="line">  <span class="attr">meta:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">pages:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">posts:</span></span><br><span class="line">    <span class="attr">title:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">date:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">path:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">text:</span> <span class="literal">false</span></span><br><span class="line">    <span class="attr">raw:</span> <span class="literal">false</span></span><br><span class="line">    <span class="attr">content:</span> <span class="literal">false</span></span><br><span class="line">    <span class="attr">slug:</span> <span class="literal">false</span></span><br><span class="line">    <span class="attr">updated:</span> <span class="literal">false</span></span><br><span class="line">    <span class="attr">comments:</span> <span class="literal">false</span></span><br><span class="line">    <span class="attr">link:</span> <span class="literal">false</span></span><br><span class="line">    <span class="attr">permalink:</span> <span class="literal">false</span></span><br><span class="line">    <span class="attr">excerpt:</span> <span class="literal">false</span></span><br><span class="line">    <span class="attr">categories:</span> <span class="literal">false</span></span><br><span class="line">    <span class="attr">tags:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure>

<h2 id="4-代码高亮"><a href="#4-代码高亮" class="headerlink" title="4.代码高亮"></a>4.代码高亮</h2><blockquote>
<p>在根目录和主题目录下，打开 <code>_config.yml</code> 文件，添加配置：</p>
</blockquote>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 代码高亮</span></span><br><span class="line"><span class="attr">highlight:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">line_number:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">auto_detect:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">tab_replace:</span> <span class="string">''</span></span><br><span class="line">  <span class="attr">wrap:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">hljs:</span> <span class="literal">false</span></span><br></pre></td></tr></table></figure>

<h2 id="5-添加图片资源"><a href="#5-添加图片资源" class="headerlink" title="5.添加图片资源"></a>5.添加图片资源</h2><blockquote>
<p>在根目录 <code>source</code> 目录下或主题目录 <code>source</code> 目录下新建 <code>img</code> 目录，将所需图片资源存入，打开文件 <code>themes\yilia-plus\_config.yml</code>, 修改配置：</p>
</blockquote>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 网站图标</span></span><br><span class="line"><span class="attr">favicon:</span> <span class="string">/img/favicon.ico</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 你的头像url</span></span><br><span class="line"><span class="attr">avatar:</span> <span class="string">/img/avatar.jpg</span>  </span><br><span class="line"></span><br><span class="line"><span class="comment"># 支付宝二维码图片地址，跟设置头像的方式一样。</span></span><br><span class="line"><span class="attr">alipay:</span> <span class="string">/img/alipay.jpg</span></span><br><span class="line"><span class="comment"># 微信二维码图片地址</span></span><br><span class="line"><span class="attr">weixin:</span> <span class="string">/img/weixin.png</span></span><br></pre></td></tr></table></figure>

<h2 id="6-左侧显示总文章数"><a href="#6-左侧显示总文章数" class="headerlink" title="6.左侧显示总文章数"></a>6.左侧显示总文章数</h2><blockquote>
<p>打开 <code>themes\yilia\layout\_partial\left-col.ejs</code> 文件</p>
</blockquote>
<p>找到下面这一段：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">nav</span> <span class="attr">class</span>=<span class="string">"header-menu"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">%</span> <span class="attr">for</span> (<span class="attr">var</span> <span class="attr">i</span> <span class="attr">in</span> <span class="attr">theme.menu</span>)&#123; %&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"&lt;%- url_for(theme.menu[i]) %&gt;"</span>&gt;</span><span class="tag">&lt;<span class="name">%=</span> <span class="attr">i</span> %&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">%&#125;%</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">nav</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>在之后添加：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">nav</span>&gt;</span></span><br><span class="line">    总文章数 <span class="tag">&lt;<span class="name">%=site.posts.length%</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">nav</span>&gt;</span></span><br></pre></td></tr></table></figure>


<h2 id="7-新建标签和分类"><a href="#7-新建标签和分类" class="headerlink" title="7.新建标签和分类"></a>7.新建标签和分类</h2><blockquote>
<p>在 <code>git bash</code> 或者 <code>cmd</code> 命令行，输入以下命令:</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hexo new page tags         <span class="comment"># 新建标签</span></span><br><span class="line">hexo new page categories   <span class="comment"># 新建分类</span></span><br></pre></td></tr></table></figure>
<p>在文件 <code>scaffolds\post.md</code> 中添加：</p>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">tags: </span><br><span class="line">categories:</span><br></pre></td></tr></table></figure>

<p>下次新建文章时，可以设置标签和分类。</p>
<h2 id="8-添加字数统计"><a href="#8-添加字数统计" class="headerlink" title="8.添加字数统计"></a>8.添加字数统计</h2><blockquote>
<p>安装 hexo-wordcount, npm install hexo-wordcount –save</p>
</blockquote>
<p>在文件 <code>themes\yilia\layout\_partial\left-col.ejs</code> 中添加：</p>
<figure class="highlight erb"><table><tr><td class="code"><pre><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">nav</span>&gt;</span></span></span><br><span class="line"><span class="xml">    总字数 <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"post-count"</span>&gt;</span><span class="tag">&lt;<span class="name">%=</span></span></span><span class="ruby"> totalcount(site, <span class="string">'0,0.0a'</span>) </span><span class="xml"><span class="tag">%&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">nav</span>&gt;</span></span></span><br></pre></td></tr></table></figure>

<p>编辑文件 <code>themes\yilia\layout\_partial\article.ejs</code>，在header下，添加：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">align</span>=<span class="string">"center"</span> <span class="attr">class</span>=<span class="string">"post-count"</span>&gt;</span></span><br><span class="line">    字数：<span class="tag">&lt;<span class="name">%=</span> <span class="attr">wordcount</span>(<span class="attr">post.content</span>) %&gt;</span>字 | 预计阅读时长：<span class="tag">&lt;<span class="name">%=</span> <span class="attr">min2read</span>(<span class="attr">post.content</span>) %&gt;</span>分钟</span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>


<h2 id="9-不蒜子统计-统计访问量"><a href="#9-不蒜子统计-统计访问量" class="headerlink" title="9.不蒜子统计-统计访问量"></a>9.不蒜子统计-统计访问量</h2><blockquote>
<p>如果主题中没有配置，则：安装不蒜子</p>
</blockquote>
<p>在文件 <code>themes\yilia\layout\_partial\after-footer.ejs</code> 末尾添加：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>  <span class="attr">async</span>  <span class="attr">src</span>=<span class="string">"https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="9-1-统计网站访问量"><a href="#9-1-统计网站访问量" class="headerlink" title="9.1.统计网站访问量"></a>9.1.统计网站访问量</h3><blockquote>
<p>如果主题中没有配置，则：</p>
</blockquote>
<p>修改文件 <code>themes\yilia\layout\_partial\footer.ejs</code>，添加访客数和站点访问总量：</p>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 总访问量</span></span><br><span class="line">&lt;span <span class="attribute">id</span>=<span class="string">"busuanzi_container_site_pv"</span>&gt;    </span><br><span class="line">    本站总访问量</span><br><span class="line">    &lt;span <span class="attribute">id</span>=<span class="string">"busuanzi_value_site_pv"</span>&gt;&lt;/span&gt;次&lt;/span&gt; |</span><br><span class="line"></span><br><span class="line"><span class="comment"># 访客记录</span></span><br><span class="line">&lt;span <span class="attribute">id</span>=<span class="string">"busuanzi_container_site_uv"</span>&gt;  </span><br><span class="line">    本站访客数</span><br><span class="line">    &lt;span <span class="attribute">id</span>=<span class="string">"busuanzi_value_site_uv"</span>&gt;&lt;/span&gt;人次&lt;/span&gt;</span><br></pre></td></tr></table></figure>

<h3 id="9-2-单篇文章点击量"><a href="#9-2-单篇文章点击量" class="headerlink" title="9.2.单篇文章点击量"></a>9.2.单篇文章点击量</h3><p>打开文件 <code>\themes\yilia-plus\layout\_partial\post\date.ejs</code>，添加： </p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">span</span> <span class="attr">id</span>=<span class="string">"busuanzi_container_page_pv"</span>&gt;</span>  本文总阅读量<span class="tag">&lt;<span class="name">span</span> <span class="attr">id</span>=<span class="string">"busuanzi_value_page_pv"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span>次<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="10-部署（GitHub-Gitee）"><a href="#10-部署（GitHub-Gitee）" class="headerlink" title="10.部署（GitHub/Gitee）"></a>10.部署（GitHub/Gitee）</h2><blockquote>
<p>这里以 <code>GitHub/Gitee pages</code> 为例，作为个人博客的静态部署</p>
</blockquote>
<p>打开根目录中的 <code>_config.yml</code> 文件，找到 <code>deploy</code> 项，修改如下配置：</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Deployment  配置部署信息</span></span><br><span class="line"><span class="comment">## Docs: https://hexo.io/docs/deployment.html</span></span><br><span class="line"><span class="attr">deploy:</span></span><br><span class="line">  <span class="attr">type:</span> <span class="string">git</span></span><br><span class="line">  <span class="comment"># repository: https://gitee.com/你的账户名/blog.git</span></span><br><span class="line">  <span class="attr">repository:</span> <span class="string">git@gitee.com:你的账户名/blog.git</span></span><br><span class="line">  <span class="attr">branch:</span> <span class="string">master</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>确保 <code>GitHub/Gitee</code> 上已开启 <code>GitHub/Gitee pages</code> 服务，部署分支选择 <code>master</code></p>
</blockquote>
<p>在 <code>Git bash</code> 或 <code>DOS窗口</code> 中，输入以下命令：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hexo deploy  <span class="comment"># 部署到GitHub/Gitee 上，需要先安装 `npm install hexo-deployer-git --save`</span></span><br></pre></td></tr></table></figure>

<h2 id="11-Hexo命令"><a href="#11-Hexo命令" class="headerlink" title="11.Hexo命令"></a>11.Hexo命令</h2><h3 id="11-1-常用命令"><a href="#11-1-常用命令" class="headerlink" title="11.1.常用命令"></a>11.1.常用命令</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hexo new <span class="string">"postName"</span>       <span class="comment">#新建文章</span></span><br><span class="line">hexo new page <span class="string">"pageName"</span>  <span class="comment">#新建页面</span></span><br><span class="line">hexo generate             <span class="comment">#生成静态页面至public目录</span></span><br><span class="line">hexo server --port==8000  <span class="comment">#开启访问（默认端口4000，`ctrl + c` 关闭），查看帮助（hexo server -help）</span></span><br><span class="line">hexo deploy               <span class="comment">#将 `.deploy_git` 目录部署到 GitHub/Gitee</span></span><br></pre></td></tr></table></figure>

<h3 id="11-2常用复合命令："><a href="#11-2常用复合命令：" class="headerlink" title="11.2常用复合命令："></a>11.2常用复合命令：</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hexo deploy -g</span><br><span class="line">hexo server -g</span><br></pre></td></tr></table></figure>

<h3 id="11-3-简写："><a href="#11-3-简写：" class="headerlink" title="11.3.简写："></a>11.3.简写：</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hexo n         ==   hexo new</span><br><span class="line">hexo g         ==   hexo generate</span><br><span class="line">hexo s -p 8000 ==   hexo server --port=8000</span><br><span class="line">hexo d         ==   hexo deploy</span><br></pre></td></tr></table></figure>


<hr>
]]></content>
      <categories>
        <category>网站</category>
        <category>Hexo</category>
      </categories>
      <tags>
        <tag>yilia</tag>
        <tag>基本配置</tag>
      </tags>
  </entry>
  <entry>
    <title>Hello World</title>
    <url>/blog/archives/16107.html</url>
    <content><![CDATA[<p>Welcome to <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="noopener">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="noopener">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="noopener">GitHub</a>.</p>
<a id="more"></a>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo new <span class="string">"My New Post"</span></span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="noopener">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/server.html" target="_blank" rel="noopener">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank" rel="noopener">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/one-command-deployment.html" target="_blank" rel="noopener">Deployment</a></p>
]]></content>
      <categories>
        <category>网站</category>
        <category>Hexo</category>
      </categories>
      <tags>
        <tag>hello world</tag>
      </tags>
  </entry>
</search>
